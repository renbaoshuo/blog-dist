<!DOCTYPE html><html lang="zh-CN"><head><meta name="viewport" content="width=device-width"><meta charset="utf-8"><link rel="alternate" type="application/atom+xml" href="/atom.xml" title="宝硕博客"><meta property="og:site_name" content="宝硕博客"><meta name="twitter:site" content="@renbaoshuo"><meta name="twitter:creator" content="@renbaoshuo"><title>拥抱 Atomic CSS-in-JS - 宝硕博客</title><meta name="description" content="当下，Atomic CSS 愈发受到人们的关注。相比于传统 CSS 编写方法中每个组件对应一个 CSS 类，使用了 Atomic CSS 以后，每一个 CSS 类都唯一对应了一条独立的 CSS 规则，随着组件数量逐渐增加、能复用的 CSS 规则越来越多，最终的 CSS 产物体积也会下降许多，使得网页的加载速度能够产生一个质的飞跃。"><meta property="og:description" content="当下，Atomic CSS 愈发受到人们的关注。相比于传统 CSS 编写方法中每个组件对应一个 CSS 类，使用了 Atomic CSS 以后，每一个 CSS 类都唯一对应了一条独立的 CSS 规则，随着组件数量逐渐增加、能复用的 CSS 规则越来越多，最终的 CSS 产物体积也会下降许多，使得网页的加载速度能够产生一个质的飞跃。"><meta name="keywords" content="[object Object],[object Object],[object Object],[object Object]"><meta property="og:type" content="article"><meta property="og:title" content="拥抱 Atomic CSS-in-JS - 宝硕博客"><meta property="og:url" content="/post/atomic-css-in-js/"><meta property="og:image" content="https://s1.baoshuo.ren/2022/07/23/R2LQrmhBxc3PEFy.webp"><link rel="canonical" href="/post/atomic-css-in-js/"><meta name="twitter:card" content="summary_large_image"><meta name="next-head-count" content="16"><meta name="darkreader" content="disabled"><script defer="" src="https://cdnjs.baoshuo.ren/ajax/libs/react/18.2.0/umd/react.production.min.js" crossorigin=""></script><script defer="" src="https://cdnjs.baoshuo.ren/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js" crossorigin=""></script><script defer="" nomodule="" src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/webpack-54fb4613fe17423e.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/framework-d9a53f0451e3b9af.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/main-c7b17abe470ec1b3.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/pages/_app-83b560b7da8fa55a.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/193-689698d9de7cf5a2.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/pages/post/%5Bslug%5D-1a91fb72cdb0fb9f.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/1i1kdh5SS5WHuE0jHcfjV/_buildManifest.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/1i1kdh5SS5WHuE0jHcfjV/_ssgManifest.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/1i1kdh5SS5WHuE0jHcfjV/_middlewareManifest.js" defer=""></script><style>.eDssNQ{pointer-events:none}.gZmUMJ{height:2px}.hJfaYF{z-index:200}.dJcTkO{box-shadow:0 0 10px var(--c-a),0 0 10px var(--c-a)}.gOeSjL{opacity:1}.fxkyut{transition:all .25s ease-in-out}.kaWzRu{transform:rotate(3deg) translateY(-4px)}.ktTKqx{width:5%}.cdfZWI:before{box-shadow:inset 0 0 32px}.zJreD:before{height:3px}.iSSyDr:before{left:1.5px}.jORRks:before{top:14px}.beaHbQ:before{width:3px}.haKUHj:after{box-sizing:border-box}.feNfPp:after{transform:translate(-50%,-50%)}.qMJeO:after{box-shadow:inset 0 0 0 2px,0 0 0 2px}.dUAgBC:after{height:27.5px}.hVfwnH:after{left:0}.jtnuen:after{top:100%}.iibzBM:after{width:27.5px}.bLLutt:before{height:.8em}.kUNXjX:before{transform:translate(0) rotate(45deg)}.kBZpXt:before{width:.8em}.kCTVgr:after{top:80%}.cDbGzW:after{left:80%}.eHPmEw:after{transform:translate(-50%,-50%) rotate(45deg)}.dmfenB:after{width:.5em}.kAVdUc{font-size:16px}.jLmWnd:before{height:100%}.jYPXoJ:before{top:0}.kKTZiz:before{left:0}.elJZFC:after{height:14px}.eLXBUo:after{width:7px}.ebtDcN:after{top:1px}.caItCN{height:2rem}.jYEAGD{align-items:stretch}.gKQCBv:after{content:"·"}.jbBqfU:before{transform:translate(-50%,-25%) rotate(45deg)}.dhOkuk:before{box-sizing:border-box}.jFCJJY:before{box-shadow:0 -.35em,0 .35em}.iqzSxf:before{transform:translate(-50%,-50%)}.bQvqKh:before{width:100%}.sKExc{right:1rem}.bjOGUo{bottom:1rem}.eSaSrN{contain:layout}.egGyMq{line-height:1}.IVbXa{justify-content:center}.bcjLCN{flex-grow:0}.WhAZY{top:0}.gdPTUr{height:100%}.dYbGIK{flex-grow:0}.bOjOhu{left:0}.ipEZTh{width:95%}.eRVtDl{max-width:var(--w)}.kKplrA{contain:content}.gifdxR{font-size:1.25rem}.laXLGQ{color:var(--c)}.kooHYa{text-align:center}.moyUB{color:#fff}.eAOGpx{user-select:none}.bLHLvQ{text-indent:-9999px}.jXmXEB{height:1em}.hHGIsI{width:1em}.jbzBdl:before{transform:translate(-25%,-50%) rotate(-45deg)}.fIXfpL:before{width:.65em}.ergVCo:before{height:.65em}.cqyuit:before{top:50%}.hCTuXM:before{left:50%}.gvwkfp{font-size:.9em}.bRNbBj{font-weight:500}.dQPgRK{flex-grow:1}.fXzCvR{justify-content:flex-end}.klEWBS{text-align:right}.foGVKH{align-items:center}.fygwnR{box-sizing:border-box}.kQBRAp{display:block}.iMyxuR:after{display:block}.bbRNPO:after{left:1px}.imhmwA{position:fixed}.dPAasc{box-shadow:var(--s)}.jqaXfP{z-index:100}.iVncgA::-webkit-scrollbar{height:var(--s-x)}.fQhDyl::-webkit-scrollbar{width:var(--s-y)}.bBVwIW{letter-spacing:1px}.jsvbrX{cursor:pointer}.kroOag{font-size:.9rem}.bEvNbr{position:absolute}.eLDTYY{vertical-align:middle}.iRjWhb{font-size:.925rem}.QcCvg{height:12.25em}.jdKAzd{width:12.25em}.krZeLX{right:-30px}.gjJDYK{top:-40px}.dZDNG{opacity:.1}.julXB:before{content:""}.kvHVCE:before{position:absolute}.fQfkux:before{height:3.75em}.dPenaT:before{width:3.75em}.NpaJd:before{left:1.5625em}.jgAayQ:before{top:3em}.fqXcHQ:after{content:""}.dyMCpl:after{position:absolute}.chpxwD:after{height:3.75em}.beuMzX:after{width:3.75em}.dbtvqd:after{right:1.5625em}.jPcnDC:after{top:3em}.bpQkXn{font-weight:700}.gcQrEv{font-size:.9em}.iMkoWi{flex-direction:column}.chVqDG{font-size:.8em}.fyuAJJ{color:inherit}.jYagCu{max-height:400px}.gWinOH{object-fit:cover}.cypeLb{font-size:1.75rem}.VFfNK{letter-spacing:.75px}.dgIPcR{color:var(--c-m)}.cjScYX{position:relative}.cRUUAa{width:100%}.gSBWlu{display:flex}.kJzccJ{justify-content:space-between}.cpOcAb{display:inline-block}.kpaoc{color:var(--c-s)}.kOZsAO{word-break:keep-all}.jBtqwC{background-color:var(--c-a)}.cTiRpf:after{border-top-left-radius:100px}.kLOwRz:after{border-top-right-radius:100px}.fEOdlm:after{border-bottom-right-radius:100px}.iiCJgG:after{border-bottom-left-radius:100px}.gbJvTx:before{border-top-left-radius:100px}.eqcbDJ:before{border-top-right-radius:100px}.efWRhG:before{border-bottom-right-radius:100px}.ciQIPM:before{border-bottom-left-radius:100px}.jVKJhP:before{border-top-left-radius:1000px}.qOQRo:before{border-top-right-radius:1000px}.ftrJDm:before{border-bottom-right-radius:1000px}.dnkCBy:before{border-bottom-left-radius:1000px}.eCTYLu:after{overflow-x:hidden}.fPEpYf:after{overflow-y:hidden}.fSuxSX:after{border-top-left-radius:1000px}.diZuuN:after{border-bottom-left-radius:1000px}.ihNVbP{flex-basis:0}.KqcXP{background-color:transparent}.eIJBjz{padding-right:.7rem}.hcJOFn{padding-left:.7rem}.iawFZL{margin-right:.4rem}.kswRdL{margin-left:.4rem}.eGElBa{padding-top:2.5rem}.eBrwtd{padding-bottom:4rem}.edKxdA{padding-top:.9rem}.osxXp{padding-right:.9rem}.foquGP{padding-bottom:.9rem}.lhTVEC{padding-left:.9rem}.eQmaZO{padding-top:.6rem}.dZrGlq{padding-bottom:.6rem}.gCwvuy{background-color:var(--g-m)}.dvivnl{overflow-x:auto}.jSOKOm{text-decoration-line:inherit}.bKjKUN{padding-top:.75rem}.jdraHW{margin-right:auto}.eqrBPF{margin-left:auto}.lexxaO{background-color:#946ce6}.ebVilo{border-top-left-radius:.25rem}.kyhYEz{border-top-right-radius:.25rem}.jIkFRm{border-bottom-right-radius:.25rem}.gpptow{border-bottom-left-radius:.25rem}.kMKXDC{padding-top:.25rem}.ftIldC{padding-right:1rem}.jOeduE{padding-bottom:.25rem}.iDuqPI{padding-left:1rem}.kUPESX{margin-left:.5rem}.eKlQYW{flex-shrink:1}.bLlOeF{flex-basis:50%}.hwgZgR:after{background-color:currentColor}.bcfNhz{background-color:var(--g-b)}.kRQsoY{border-top-left-radius:var(--r)}.jBvrhX{border-top-right-radius:var(--r)}.dgtTIu{border-bottom-right-radius:var(--r)}.eXJtsk{border-bottom-left-radius:var(--r)}.llUCyD{overflow-y:auto}.qlVwF::-webkit-scrollbar-thumb{background-color:#b5b5b5}.jOHNtp::-webkit-scrollbar-thumb{border-top-left-radius:var(--r)}.PvULj::-webkit-scrollbar-thumb{border-top-right-radius:var(--r)}.hTxdYE::-webkit-scrollbar-thumb{border-bottom-right-radius:var(--r)}.fUqTQL::-webkit-scrollbar-thumb{border-bottom-left-radius:var(--r)}.kVZHcH{padding-top:0}.cyerGB{margin-top:.5rem}.dSxtaa{margin-right:.5rem}.ctWdVF{border-top-left-radius:50%}.jkGfDR{border-top-right-radius:50%}.bSTogt{border-bottom-right-radius:50%}.hSDpeY{border-bottom-left-radius:50%}.cDxIqC:before{border-top-left-radius:50%}.jpWidM:before{border-top-right-radius:50%}.jzdNVF:before{border-bottom-right-radius:50%}.bPkdhG:before{border-bottom-left-radius:50%}.beJoMJ:after{border-top-left-radius:50%}.iJgiCW:after{border-top-right-radius:50%}.hqUHPA:after{border-bottom-right-radius:50%}.jWWlrr:after{border-bottom-left-radius:50%}.jnGacs{background-color:var(--g-l)}.cvPkWa{padding-bottom:1.25rem}.dUvWpK{overflow-x:hidden}.hRLVFh{overflow-y:hidden}.dLUwcr{text-decoration-line:underline}.kiDYix{flex-wrap:wrap}.hriXhD{flex-shrink:0}.jjryqL{margin-right:1rem}.jTjNVR{margin-top:0}.hNjeNG{margin-bottom:0}.kpCrIt{padding-top:1.25rem}.bMSzLf{padding-right:2rem}.iATxZH{padding-bottom:0}.iigETV{padding-left:2rem}.fClzDx{margin-top:.75rem}.iKck{margin-right:0}.hlBtvm{margin-bottom:.75rem}.bmFLeF{margin-left:0}.dwawJR{padding-right:0}.jQenOz{padding-left:0}.icKiSN{padding-top:1.5rem}.fZMRmg{padding-bottom:1.5rem}.cUXNmd{margin-top:1rem}.biWxPv{margin-bottom:1rem}.bbUXPo{text-decoration-line:none}.dmKgnC{padding-top:.5rem}.cVJMrm{padding-right:.5rem}.dPFrWx{padding-bottom:.5rem}.JxWnH{padding-left:.5rem}.dAseSU:after{border-top-width:4px}.gFfWNi:after{border-right-width:4px}.hQijyr:after{border-bottom-width:4px}.cKXpgz:after{border-left-width:4px}.jxivWg:after{border-top-color:transparent}.eoMfVT:after{border-bottom-color:transparent}.iOXMHb:after{border-left-color:transparent}.dbfKrc:after{border-top-width:2px}.jAobFs{border-top-style:none}.dQbyJV{border-right-style:none}.oTbqa{border-bottom-style:none}.gwsGKP{border-left-style:none}.SeaTL:before{border-top-width:2px}.gjJuRC:before{border-right-width:0}.iWYpgm:before{border-bottom-width:0}.iHkzF:before{border-left-width:2px}.gUiFRX:before{border-top-width:0}.dixaxG:before{border-right-width:2px}.jmWgOv:before{border-bottom-width:2px}.bTanCN:before{border-left-width:0}.gMDOZu{border-top-width:1.125em}.cgEEZJ{border-right-width:1.125em}.gqWyNB{border-bottom-width:1.125em}.ktfQGr{border-left-width:1.125em}.lpnDDz:before{border-top-width:1em}.ebRqqn:before{border-right-width:1em}.bWKMJW:before{border-bottom-width:1em}.eQlDDM:before{border-left-width:1em}.kSnqYR:before{border-top-style:solid}.fgiDpI:before{border-right-style:solid}.eeAUEW:before{border-bottom-style:solid}.ecjlX:before{border-left-style:solid}.bnSwfb:before{border-right-color:transparent}.jMYtKl:after{border-top-width:1em}.blQfIT:after{border-right-width:1em}.lijgUQ:after{border-bottom-width:1em}.ccSWYO:after{border-left-width:1em}.eGyfkC:after{border-top-style:solid}.hhBXzE:after{border-right-style:solid}.iyXZtO:after{border-bottom-style:solid}.jZLyOQ:after{border-left-style:solid}.hZGkn:after{border-right-color:transparent}.FwRrA{border-top-style:solid}.cDIyHz{border-right-style:solid}.hpBjJb{border-bottom-style:solid}.ycSPk{border-left-style:solid}@media (min-width:769px){.dXUryZ{padding-top:0}.dGtUgz{padding-right:1rem}.cQUTzq{padding-bottom:0}.bjXFvo{padding-left:1rem}.jzScEz{padding-top:2.5rem}.hMoAFf{padding-right:3rem}.bccxkr{padding-bottom:4rem}.cgjdEA{padding-left:3rem}.jZOgvY{display:flex}.uUxpw{justify-content:space-between}}@media (max-width:768px){.cElyNr{flex-direction:column}.gwFLA_D{align-items:center}}.cdhcuu:hover{color:var(--c-a)}.fItHnb:hover{background-color:var(--g-n)}*,:after,:before{box-sizing:border-box}html{-moz-tab-size:4;-o-tab-size:4;tab-size:4;line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji}strong{font-weight:bolder}code,pre{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:1em}button{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button{text-transform:none}button{-webkit-appearance:button}:root{--g:#f2f5f8;--g-m:#fff;--g-b:#fff;--g-s:#f6f7f8;--g-p:#f6f8fa;--g-c:rgba(174,184,193,.2);--g-n:rgba(67,90,111,.06);--g-t:#fff;--g-l:#f5f5f5;--g-i:#fff;--g-r:hsla(200,5%,89%,.5);--c:#2f3d4e;--c-a:#0969da;--c-s:#57606a;--c-m:#6f767d;--h6:#57606b;--b:#d8dee4;--b-t:#d0d7de;--r:0.5rem;--s-y:0.5rem;--s-x:0.35rem;--w:1000px;--s:0 4px 10px rgba(0,2,4,.06),0 0 1px rgba(0,2,4,.11);--i:0}@media(max-width:768px){:root{--s-y:0.35rem;--s-x:0.28rem}}@media(prefers-color-scheme:dark){:root:not(.light){color-scheme:dark;--g:#121212;--g-m:#21262d;--g-b:#364151;--g-s:#2f3542;--g-p:#161b22;--g-c:hsla(215,8%,47%,.4);--g-n:#3e4b5e;--g-t:#2f3542;--g-l:#2c343c;--g-i:#3b3b3b;--g-r:rgba(51,61,77,.5);--c:#c9d1d9;--c-a:#58a6ff;--c-s:#8b949e;--c-m:hsla(0,0%,100%,.659);--h6:#8b949e;--b:#757575;--b-t:#5f5f5f;--s:none;--i:1}:root:not(.light) img{filter:brightness(.8)}}body{line-height:1.5;background:var(--g);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,PingFang SC,Hiragino Sans GB,Source Han Sans SC,Noto Sans CJK SC,Microsoft YaHei,WenQuanYi Micro Hei,WenQuanYi Zen Hei,Helvetica Neue,Arial,sans-serif;color:var(--c);overflow-y:scroll}#__next{display:flex;flex-direction:column;justify-content:space-between;min-height:100vh}*{transition:background-color .25s ease-in-out}a{color:var(--c-a);text-decoration:none}#post_markdown__nRdJ1{line-height:1.5;word-wrap:break-word}#post_markdown__nRdJ1>:first-child{margin-top:0!important}#post_markdown__nRdJ1>:last-child{margin-bottom:0!important}#post_markdown__nRdJ1 a{color:var(--c-a);-webkit-text-decoration:underline transparent;text-decoration:underline transparent;text-underline-position:under;transition:-webkit-text-decoration-color 75ms ease-in-out;transition:text-decoration-color 75ms ease-in-out;transition:text-decoration-color 75ms ease-in-out,-webkit-text-decoration-color 75ms ease-in-out}#post_markdown__nRdJ1 a:active,#post_markdown__nRdJ1 a:hover{outline-width:0}#post_markdown__nRdJ1 a:hover{-webkit-text-decoration:underline var(--c-a);text-decoration:underline var(--c-a)}#post_markdown__nRdJ1 strong{font-weight:700}#post_markdown__nRdJ1 img{border-style:none;max-width:100%;box-sizing:content-box}#post_markdown__nRdJ1 h2,#post_markdown__nRdJ1 h3,#post_markdown__nRdJ1 h4{margin-top:1.5rem;margin-bottom:1rem;font-weight:700;line-height:1.25}#post_markdown__nRdJ1 h2{font-size:1.5em}#post_markdown__nRdJ1 h3{font-size:1.25em}#post_markdown__nRdJ1 h4{font-size:1em}#post_markdown__nRdJ1 p{margin-top:0;margin-bottom:.625rem}#post_markdown__nRdJ1 ol,#post_markdown__nRdJ1 ul{margin-top:0;margin-bottom:0;padding-left:2em}#post_markdown__nRdJ1 li+li{margin-top:.25em}#post_markdown__nRdJ1 code{font-family:ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace;font-size:.75em;margin:0;padding:.2em .4em;background-color:var(--g-c);border-radius:6px}#post_markdown__nRdJ1 pre{padding:1rem;overflow:auto;font-size:.85em;line-height:1.45;background-color:var(--g-p);border-radius:6px;word-wrap:normal}#post_markdown__nRdJ1 pre::-webkit-scrollbar{height:var(--s-x);width:var(--s-y)}#post_markdown__nRdJ1 pre::-webkit-scrollbar-thumb{background:#b5b5b5;border-radius:var(--r)}#post_markdown__nRdJ1 pre code{font-size:100%;display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background:transparent;border:0}#post_markdown__nRdJ1 ol,#post_markdown__nRdJ1 p,#post_markdown__nRdJ1 pre,#post_markdown__nRdJ1 ul{margin-top:0;margin-bottom:1rem}#post_markdown__nRdJ1 .hljs-keyword{color:#d73a49}#post_markdown__nRdJ1 .hljs-title,#post_markdown__nRdJ1 .hljs-title.function_{color:#6f42c1}#post_markdown__nRdJ1 .hljs-attr,#post_markdown__nRdJ1 .hljs-attribute,#post_markdown__nRdJ1 .hljs-number,#post_markdown__nRdJ1 .hljs-selector-class{color:#005cc5}#post_markdown__nRdJ1 .hljs-string{color:#032f62}#post_markdown__nRdJ1 .hljs-built_in{color:#e36209}#post_markdown__nRdJ1 .hljs-name{color:#22863a}</style><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/3fc16492cd6995f6.css" data-n-g="" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/3fc16492cd6995f6.css"></noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/1550b18fa9b2cc2d.css" data-n-g="" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/1550b18fa9b2cc2d.css"></noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/49e3c9be9aebdd02.css" data-n-p="" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/49e3c9be9aebdd02.css"></noscript><noscript data-n-css=""></noscript></head><body><div id="__next"><div class="eDssNQ imhmwA bOjOhu WhAZY cRUUAa gZmUMJ hJfaYF KqcXP "><div class="gdPTUr jBtqwC fxkyut " style="opacity:0;width:0%"><div class="bEvNbr ktTKqx gdPTUr fxkyut dJcTkO gOeSjL kaWzRu " style="left:-5.5%"></div></div></div><div><nav class="gSBWlu kJzccJ gCwvuy eAOGpx dPAasc eSaSrN cjScYX jqaXfP cElyNr gwFLA_D dXUryZ dGtUgz cQUTzq bjXFvo " role="navigation"><a class="gSBWlu bcjLCN hriXhD foGVKH gifdxR bpQkXn fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn bBVwIW " href="/"><svg id="Main" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="caItCN dSxtaa "><path d="M471,256A214.8122,214.8122,0,0,1,256,471a216.4337,216.4337,0,0,1-40.955-3.896A214.86,214.86,0,0,1,41,256,214.9809,214.9809,0,0,1,256,41a214.4584,214.4584,0,0,1,154.4137,65.4129q6.911,7.1214,13.146,14.8661c1.3337,1.6587,2.6413,3.3258,3.9229,5.0281A214.5854,214.5854,0,0,1,471,256Z" fill="#5897d1"></path><path d="M419.2572,204.2572A163.1145,163.1145,0,0,1,256,367.5136a164.3664,164.3664,0,0,1-31.0985-2.9579A163.271,163.271,0,1,1,419.2572,204.2572Z" fill="#9fc5e6"></path><path d="M418.8558,63.0971v44.65A10.5833,10.5833,0,0,1,408.2729,118.33H333.7074V52.5134h74.5655A10.584,10.584,0,0,1,418.8558,63.0971Z" fill="#ff668c"></path><path d="M329.7492,458.0118A215.2574,215.2574,0,0,1,60.2534,345.0537l67.6679-90.0019a30.79,30.79,0,0,1,49.2216,0l38.5328,51.2574Z" fill="#343a6e"></path><path d="M408.6937,77.1989a8.2229,8.2229,0,0,1-8.2229,8.223H371.8716a8.2271,8.2271,0,0,0,0,16.4542h9.8724a8.2271,8.2271,0,1,1,0,16.4542H333.7065V52.5134h46.87a8.2238,8.2238,0,0,1,8.2229,8.2313,8.2246,8.2246,0,0,0,8.2313,8.2229h3.44A8.23,8.23,0,0,1,408.6937,77.1989Z" fill="#ef487d"></path><path d="M328.6658,41.0008h0a7.2391,7.2391,0,0,0-7.2394,7.24V230.2126h14.4789V48.24A7.24,7.24,0,0,0,328.6658,41.0008Z" fill="#f9df73"></path><path d="M454.3619,339.0513q-2.87,6.8317-6.1872,13.4266A215.3468,215.3468,0,0,1,215.045,467.104a214.1378,214.1378,0,0,1-82.1653-34.83L299.2368,211.0171a36.8115,36.8115,0,0,1,58.8571,0Z" fill="#484b7f"></path><path d="M328.67,196.3173c-5.6429,0-11.285,4.8972-15.0584,14.699L215.045,467.104a213.7775,213.7775,0,0,1-82.1653-34.83L299.2461,211.0171A36.578,36.578,0,0,1,328.67,196.3173Z" fill="#343a6e"></path><path d="M448.1747,352.4779A215.3468,215.3468,0,0,1,215.045,467.104a213.4209,213.4209,0,0,1-59.4366-20.9382L264.82,337.7974c-17.0068,44.185,31.1885,55.6372,81.2087,37.2085C391.9237,358.0939,396.8116,340.0692,448.1747,352.4779Z" fill="#343a6e"></path><path d="M215.6766,306.31c-25.6245.886-50.9072,16.0419-67.0884,16.0419-25.0106,0-54.584-22.1845-20.6661-67.2992a30.79,30.79,0,0,1,49.2216,0Z" fill="#484b7f"></path></svg><span>宝硕博客</span></a><div class="gSBWlu jYEAGD dvivnl iVncgA fQhDyl qlVwF jOHNtp PvULj hTxdYE fUqTQL "><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/">首页</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/archives/">归档</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/categories/">分类</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/tags/">标签</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/friends/">友链</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/about/">关于</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/atom.xml"><i class="cpOcAb cjScYX hHGIsI jXmXEB bLHLvQ eLDTYY kAVdUc dUvWpK hRLVFh julXB dhOkuk kvHVCE gbJvTx eqcbDJ efWRhG ciQIPM iqzSxf cdfZWI zJreD iSSyDr jORRks beaHbQ fqXcHQ haKUHj dyMCpl cTiRpf kLOwRz fEOdlm iiCJgG feNfPp dAseSU gFfWNi hQijyr cKXpgz eGyfkC hhBXzE iyXZtO jZLyOQ jxivWg hZGkn eoMfVT iOXMHb qMJeO dUAgBC hVfwnH jtnuen iibzBM "></i></a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/search/"><i class="fygwnR cpOcAb kAVdUc jXmXEB hHGIsI cjScYX bLHLvQ eLDTYY julXB kvHVCE SeaTL dixaxG jmWgOv iHkzF kSnqYR fgiDpI eeAUEW ecjlX gbJvTx eqcbDJ efWRhG ciQIPM bLLutt kKTZiz jYPXoJ kUNXjX kBZpXt fqXcHQ dyMCpl dbfKrc eGyfkC kCTVgr cDbGzW eHPmEw dmfenB "></i></a><div class="dYbGIK eKlQYW ihNVbP "><button class="jsvbrX gdPTUr gSBWlu foGVKH IVbXa eQmaZO eIJBjz dZrGlq hcJOFn jAobFs dQbyJV oTbqa gwsGKP KqcXP fItHnb "><i class="cpOcAb kAVdUc jXmXEB hHGIsI cjScYX bLHLvQ eLDTYY julXB kvHVCE bQvqKh jLmWnd SeaTL dixaxG jmWgOv iHkzF kSnqYR fgiDpI eeAUEW ecjlX jVKJhP qOQRo ftrJDm dnkCBy jYPXoJ kKTZiz fqXcHQ dyMCpl iMyxuR hwgZgR eCTYLu fPEpYf fSuxSX diZuuN elJZFC eLXBUo ebtDcN bbRNPO "></i></button></div></div></nav><main><article class="gCwvuy kRQsoY jBvrhX dgtTIu eXJtsk dvivnl llUCyD dPAasc ipEZTh eRVtDl cUXNmd jdraHW biWxPv eqrBPF"><img class="cRUUAa jYagCu gWinOH " src="https://s1.baoshuo.ren/2022/07/23/R2LQrmhBxc3PEFy.webp" alt="拥抱 Atomic CSS-in-JS"><header class="jTjNVR iKck hNjeNG bmFLeF dmKgnC bMSzLf iATxZH iigETV "><h1 class="fClzDx iKck hlBtvm bmFLeF cypeLb VFfNK ">拥抱 Atomic CSS-in-JS</h1><div class="dmKgnC dwawJR dPFrWx jQenOz dgIPcR "><time datetime="2022-07-23T09:30:29.000Z">2022-07-23</time><span class="jTjNVR iawFZL hNjeNG kswRdL gKQCBv "></span><a class="fyuAJJ bbUXPo cdhcuu " href="/categories/%E6%8A%80%E6%9C%AF%E5%90%91/">技术向</a><span class="jTjNVR iawFZL hNjeNG kswRdL gKQCBv "></span><span>约 3.1 千字</span></div></header><section class="jTjNVR iKck hNjeNG bmFLeF bKjKUN bMSzLf fZMRmg iigETV kKplrA " id="post_markdown__nRdJ1"><p>当下，Atomic CSS 愈发受到人们的关注。相比于传统 CSS 编写方法中每个组件对应一个 CSS 类，使用了 Atomic CSS 以后，每一个 CSS 类都唯一对应了一条独立的 CSS 规则，随着组件数量逐渐增加、能复用的 CSS 规则越来越多，最终的 CSS 产物体积也会下降许多，使得网页的加载速度能够产生一个质的飞跃。</p><span id="more"></span><h2 id="css-编写方法的发展历程">CSS 编写方法的发展历程</h2><p>在介绍 Atomic CSS 之前，让我们先来回顾一下 CSS 编写方法的发展历程。</p><h3 id="smacss">SMACSS</h3><p><a href="http://smacss.com" rel="external nofollow noreferrer">SMACSS</a>（Scalable &amp; Modular Architecture for CSS），是由 Jonathan Snook 提出的 CSS 理论。其主要原则有 3 条：</p><ul><li>Categorizing CSS Rules（为 CSS 分类）</li><li>Naming Rules（命名规则）</li><li>Minimizing the Depth of Applicability（最小化适配深度）</li></ul><h4 id="规则分类">规则分类</h4><p>SMACSS 将规则分为了五类：Base（基础）、Layout（布局）、Module（模块）、State（状态）、Theme（主题）。</p><p><strong>基础（Base）</strong> 规则里放置默认样式。这些默认样式基本上都是元素选择器，不过也可以包含属性选择器，伪类选择器，孩子选择器，兄弟选择器。本质上来说，一个基础样式定义了元素在页面的任何位置应该是怎么样的。</p><p><strong>布局（Layout）</strong> 规则将页面拆分成几个部分，每个部分都可能有一到多个模块。顾名思义，这个分类主要用来做页面的整体或其中一块区域的布局。</p><p><strong>模块（Modules）</strong> 是我们的设计当中可重用，可模块化的部分。插图，侧边栏，文章列表等等都属于模块。</p><p><strong>状态（State）</strong> 规则定义了我们的模块或者布局在特殊的状态下应该呈现怎样的效果。它可能定义模块、布局在不同显示屏上应该如何显示。也可能定义一个模块在不同页面（例如主页和内页）中可能呈现怎么样的效果。</p><p><strong>主题（Theme）</strong> 规则和状态规则类似，定义模块或者布局的外观。很多网站的「深色模式」「换肤」等等功能就是这样实现的。</p><h4 id="命名规则">命名规则</h4><p>将规则分成五类之后，还需要命名规范。命名规范能够使得我们立刻了解到某个样式属于哪一类，以及它在整个页面中起到的作用。在一个大型项目中，我们可能会将一个样式分割成几个文件，这个时候命名约定能够使得我们更容易知道这个样式属于哪个文件。</p><p>推荐使用前缀来区分布局、模块和状态等等规则。比如对布局规则使用 <code>layout-</code> 前缀，对状态规则使用 <code>is-</code> 前缀就说一个不错的选择。</p><h4 id="最小化适配深度">最小化适配深度</h4><p>尽量不要依赖文档树的结构来编写样式。这样可以让我们的样式更加灵活，并且容易维护。</p><h3 id="bem">BEM</h3><p><a href="http://getbem.com" rel="external nofollow noreferrer">BEM</a>（ Block Element Modifier）是由 Yandex 团队提出的一种前端 CSS 命名方法论。它是一个简单又非常有用的命名约定。让前端代码更容易阅读和理解，更容易协作，更容易控制，更加健壮和明确，而且更加严密。</p><p>BEM 命名约定的模式是：</p><pre><code class="hljs css"><span class="hljs-selector-class">.block</span> {
}

<span class="hljs-selector-class">.block__element</span> {
}

<span class="hljs-selector-class">.block--modifier</span> {
}</code></pre><ul><li><code>block</code> 代表了「块」，用于组件本体。</li><li><code>element</code> 代表了「块」中的某个「元素」（也可以叫做「子组件」），是块构成的主要成员。</li><li><code>modifier</code> 代表了「块」的修饰符，表示不同的状态和版本。使用 <code>--</code> 做区分，适用于「块」和「元素」，分别称之为「块修饰符」和「元素修饰符」。</li></ul><p>命名的不同部分之间之所以使用 <code>__</code> 和 <code>--</code> 分割，是因为如果某部分中如果出现了多个单词需要使用 <code>-</code> 分隔，这样可以避免造成混淆。</p><h3 id="css-modules">CSS Modules</h3><p>随着时代的发展，一个大型前端工程中的 CSS 类名越来越多，此时难免会出现类名冲突的情况，此时 CSS Modules 应运而生 —— 它通过为 CSS 类名添加 Hash 等方式来产生唯一的名称来防止冲突的产生。</p><p><a href="https://github.com/css-modules/css-modules" rel="external nofollow noreferrer">CSS Modules</a> 并不是 CSS 官方的标准，也不是浏览器的特性，而是使用一些构建工具，比如 Webpack，对 CSS 类名和选择器限定作用域的一种方式。</p><h3 id="utility-first-css">Utility-First CSS</h3><p>当传统大型项目使用的 CSS 方法论还都大多是上方提到的 OOCSS、SMACSS、BEM 等等主要聚焦在「关注点分离」的「语义化 CSS」方案的时候，Utility-First 的 CSS 概念脱颖而出、逐渐受到社区的关注。而这之中最为被人熟知的、也最典型的就是 <a href="https://tailwindcss.com" rel="external nofollow noreferrer">Tailwind CSS</a> 了。</p><p>Utility-First CSS 不像 Semantic CSS 那样将组件样式放在一个类中，而是为我们提供一个由不同功能类组成的工具箱，我们可以将它们混合在一起应用在页面元素上。这样有几个好处：</p><ul><li>不用纠结于类名的命名；</li><li>功能越简单的类，复用率越高，可以减小最终的打包大小；</li><li>不存在全局样式污染问题；</li><li>等等。</li></ul><p>但也存在一些不足：</p><ul><li><code>class</code> 属性的内容过长；</li><li>存在 CSS 规则插入顺序相关的问题；</li><li>不能通过语义化类名得知组件的作用；</li><li>不压缩的话构建产物体积过大。</li></ul><h2 id="新时代，来临了-——-atomic-css-in-js">新时代，来临了 —— Atomic CSS-in-JS</h2><p>在前文介绍的 Utility-First CSS 的基础之上更进一步，Atomic CSS 便映入了人们的眼帘。</p><p>Atomic CSS 背后的思想与以往的「关注点分离」的思想可以称得上是背道而驰了。使用 Atomic CSS 时实际上将结构层和样式层耦合在了一起，这样的方式在现代 CSS-in-JS 的代码库中基本上得到了广泛认可，下文将会进行进一步的介绍。</p><p>Atomic CSS 可以看作是 Utility-First CSS 的极致抽象版本，每一个 CSS 类都对应一条单一的 CSS 规则。可面对如此繁复的 CSS 规则，手写 Atomic CSS 的类名并不是一个好的办法。于是 Atomic CSS-in-JS 应运而生，它可以看作是「自动化的 Atomic CSS」：</p><ul><li>无需手动设计 CSS 类名；</li><li>能够提取页面的关键 CSS，并进行代码拆分；</li><li>可以解决经典的 CSS 规则插入顺序的问题。</li></ul><h3 id="传统-css-编写方式的缺点">传统 CSS 编写方式的缺点</h3><p>Christopher Chedeau 一直致力于推广 React 生态系统中 CSS-in-JS 理念。在很多次演讲中，他都解释了 CSS 的几大问题：</p><p><img src="https://s1.baoshuo.ren/2022/07/23/5PTlQWfhkVZObpJ.png" alt="" loading="lazy"></p><ol><li>全局命名空间</li><li>依赖</li><li>无用代码消除</li><li>代码压缩</li><li>共享常量</li><li>非确定性（Non-Deterministic）解析</li><li>隔离</li></ol><p>虽然 Utility-First CSS 和 Atomic CSS 也解决了其中的一些问题，但它们无法解决所有问题（特别是样式的非确定性解析）。</p><p>举个例子：Tailwind CSS 会在生成时生成出来许多无用代码，导致样式文件体积的增长，看看下面这份代码：</p><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"before:bg-white before:p-4"</span>&gt;</span>content<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre><p>生成出来的样式文件长这个样子：</p><pre><code class="hljs css"><span class="hljs-selector-class">.before</span>\:bg-white::before {
  <span class="hljs-attribute">content</span>: <span class="hljs-built_in">var</span>(--tw-content);
  <span class="hljs-attr">--tw-bg-opacity</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">255</span> <span class="hljs-number">255</span> <span class="hljs-number">255</span> / <span class="hljs-built_in">var</span>(--tw-bg-opacity));
}

<span class="hljs-selector-class">.before</span>\:p-<span class="hljs-number">4</span>::before {
  <span class="hljs-attribute">content</span>: <span class="hljs-built_in">var</span>(--tw-content);
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">1rem</span>;
}</code></pre><p>可以看到这份文件中包括了许多的无用代码，比如重复的 <code>content: var(--tw-content)</code>。</p><h3 id="更小的构建产物">更小的构建产物</h3><p>传统的 CSS 编写方法无法复用组件间重复的 CSS 规则，比如下图中高亮的几条规则各自躺在它们对应的 CSS 类中：</p><p><img src="https://arina.loli.net/2022/07/23/TKvwu6PpgxalrsG.png" alt="" loading="lazy"></p><p>这样会导致 CSS 产物大小与项目的复杂程度和组件数量线性正相关。</p><p>但使用 Atomic CSS 之后，这些规则被提取出来进行复用：</p><p><img src="https://arina.loli.net/2022/07/23/xKRoETDVqQBgFcf.png" alt="" loading="lazy"></p><p>随着后期组件数量逐渐增加、能复用的 CSS 规则越来越多、最终 CSS 产物大小与项目复杂程度呈对数关系：</p><p><img src="https://s1.baoshuo.ren/2022/07/16/Uq6nbJXidShyzH8.png" alt="" loading="lazy"></p><p>Facebook 分享了他们的数据：在旧网站上，仅登录页就需要加载 413 KiB 的样式文件，而在使用 Atomic CSS-in-JS 重写后，整个站点只有 74 KiB 的样式文件，还包括了深色模式。</p><p>虽然在使用 Atomic CSS 之后，HTML 的体积会显著增大，不过由于这些类名的高冗余度，可以利用 gzip 来压缩掉很大一部分体积。</p><h3 id="处理-css-规则的插入顺序">处理 CSS 规则的插入顺序</h3><p>让我们再来回顾一遍这个经典的 CSS 规则插入顺序的问题：</p><p><img src="https://s1.baoshuo.ren/2022/07/23/dfu1NqZ7i3pmOrM.png" alt="" loading="lazy"></p><p>我们都知道，最后生效的样式不是最后一个类名对应的规则，而是样式表中最后插入的规则。</p><p>那么，如何在 CSS-in-JS 中处理这个问题呢？通用的做法是在生成阶段就将冲突的规则过滤掉，以避免产生冲突。比如下面这个组件：</p><pre><code class="hljs js"><span class="hljs-keyword">const</span> styles = style9.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">card</span>: {
    <span class="hljs-attr">marginTop</span>: <span class="hljs-string">'10px'</span>,
    <span class="hljs-attr">marginBottom</span>: <span class="hljs-string">'10px'</span>,
  },
  <span class="hljs-attr">profileCard</span>: {
    <span class="hljs-attr">marginBottom</span>: <span class="hljs-string">'20px'</span>,
  },
});

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Component</span> = (<span class="hljs-params"></span>) =&gt; (
  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{style9(styles.card,</span> <span class="hljs-attr">styles.profileCard</span>)} /&gt;</span></span>
);</code></pre><p>过滤后组件的实际样式如下：</p><pre><code class="hljs css"><span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;
<span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;</code></pre><p>但 CSS 中有一些简写规则，如果只按照规则名称来处理显然是不行的。有的库强制开发者们不使用简写规则来避免这个问题，而另外的一些库则将这些简写规则展开成多条规则后再进行过滤，比如 <code>margin: 10px</code> 可以被拆成 <code>margin-top: 10px</code>、<code>margin-right: 10px</code>、<code>margin-bottom: 10px</code>、<code>margin-left: 10px</code> 四条独立的规则。</p><h3 id="经典实现">经典实现</h3><p>Atomic CSS-in-JS 实现有运行时（Runtime）和预编译（Pre-Compile）两种。</p><h4 id="运行时（runtime）">运行时（Runtime）</h4><p><a href="https://styletron.org" rel="external nofollow noreferrer">Styletron</a> 是 Uber 公司开发的一个较为典型的运行时 Atomic CSS-in-JS 库，驱动了 Uber 的官网和 H5 页面。其优点在于可以动态生成样式，相比于下文中采用预编译方法的库来说灵活度高了不止一点半点。其缺点则在于 Vendor Prefix 等操作需要在 Runtime 执行，因此 Bundle 中必须携带相关依赖导致体积增大。与其相类似的还有沃尔沃汽车前技术主管的 <a href="https://fela.js.org/" rel="external nofollow noreferrer">Fela</a>（驱动了沃尔沃汽车官网，Cloudflare Dashboard 和 Medium 等众多网站），在此不做过多叙述，感兴趣的读者可以自行了解。</p><h4 id="预编译（pre-compile）">预编译（Pre-Compile）</h4><p><a href="https://www.youtube.com/watch?v=9JZHodNR184" rel="external nofollow noreferrer">Stylex</a> 是 Meta（原 Facebook）的一个尚未开源的预编译 Atomic CSS-in-JS 库。其优点在于无需将相关依赖打包发送给客户端，改善了性能。而缺点则是预编译的过程高度依赖静态代码分析，所以难以实现动态样式生成与组合。不过由于 Meta 迟迟不开源 stylex，社区中已经涌现出了数个基于其思想的开源实现，以 <a href="https://github.com/seek-oss/vanilla-extract" rel="external nofollow noreferrer">vanilla-extract</a> 最为知名，除此之外还有 <a href="https://github.com/johanholmerin/style9" rel="external nofollow noreferrer">style9</a>、<a href="https://github.com/necolas/styleq" rel="external nofollow noreferrer">styleQ</a> 等等。</p><p>将视线从 stylex 上转移开来，Atlassian 还编写了一个名为 <a href="https://compiledcssinjs.com/" rel="external nofollow noreferrer">compiled</a> 的预编译 Atomic CSS-in-JS 库，但在笔者的实际使用过程中坑点较多，可能会导致样式的重复生成，并且其对 TypeScript 的支持也不尽人意，遂弃之。</p><h4 id="其他">其他</h4><p>微软最近开源的 <a href="https://github.com/microsoft/griffel" rel="external nofollow noreferrer">Griffel</a> 既支持运行时模式，又支持预编译模式，同时拥有着更佳的 TypeScript 支持，不失为一个好的选择。这个库目前驱动了微软官方的 <a href="https://developer.microsoft.com/en-us/fluentui" rel="external nofollow noreferrer">Fluent UI</a>。</p><h2 id="后记">后记</h2><p>以上就是本文要介绍关于 Atomic CSS 的全部内容了。</p><p>虽然 Atomic CSS-in-JS 是 React 生态系统中新涌起的一股潮流，但在使用前一定要三思 —— 这个方案到底符不符合项目的需求，而不是盲目地「为了使用而使用」，给将来的维护工作埋雷，但如果使用它能带来显而易见的好处，那么何乐而不为呢？</p><p>笔者才疏学浅，只是在前人的基础之上做了一些微小的工作而已，文章中如有错误欢迎在评论区指正。感谢 <a href="https://skk.moe" rel="external nofollow noreferrer">Sukka</a> 大佬在本文编写过程中的指导。</p><h2 id="参考资料-2">参考资料</h2><ol><li><a href="https://sebastienlorber.com/atomic-css-in-js" rel="external nofollow noreferrer">Atomic CSS-in-JS</a>，Sébastien Lorber，2020 年 4 月 27 日。</li><li><a href="https://mongkii.com/blog/2021-07-26-talk-about-atomic-css" rel="external nofollow noreferrer">聊聊原子类（Atomic CSS）</a>，Mongkii，2021 年 7 月 26 日。</li><li><a href="http://acgtofe.com/posts/2014/09/valuable-theories-of-css" rel="external nofollow noreferrer">值得参考的 CSS 理论：OOCSS、SMACSS 与 BEM</a>，ACGTOFE，2014 年 9 月 30 日。</li><li><a href="https://tailwindcss.com/docs/utility-first" rel="external nofollow noreferrer">Utility-First Fundamentals</a>，Tailwind CSS。</li></ol></section><div class="cjScYX jnGacs kpCrIt bMSzLf cvPkWa iigETV dUvWpK hRLVFh "><div class="bpQkXn ">拥抱 Atomic CSS-in-JS</div><div><a class="kpaoc dLUwcr gcQrEv cdhcuu " href="/post/atomic-css-in-js/">https://blog.baoshuo.ren/post/atomic-css-in-js/</a></div><div class="gSBWlu kiDYix cUXNmd "><div class="gSBWlu iMkoWi hriXhD jjryqL biWxPv "><div class="chVqDG ">本文作者</div><div><a class="fyuAJJ bbUXPo cdhcuu " href="https://baoshuo.ren" target="_blank">宝硕</a></div></div><div class="gSBWlu iMkoWi hriXhD jjryqL biWxPv "><div class="chVqDG ">发布于</div><time datetime="2022-07-23T09:30:29.000Z">2022-07-23</time></div><div class="gSBWlu iMkoWi hriXhD jjryqL biWxPv "><div class="chVqDG ">版权协议</div><div><a class="fyuAJJ bbUXPo cdhcuu " href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.zh-Hans" target="_blank" rel="license noopener noreferrer">CC BY-NC-SA 4.0</a></div></div></div><div class="chVqDG ">转载或引用本文时请遵守许可协议，注明出处、不得用于商业用途！</div><i class="cpOcAb bEvNbr eLDTYY iRjWhb QcCvg jdKAzd krZeLX gjJDYK dZDNG gMDOZu cgEEZJ gqWyNB ktfQGr FwRrA cDIyHz hpBjJb ycSPk ctWdVF jkGfDR bSTogt hSDpeY julXB kvHVCE lpnDDz ebRqqn bWKMJW eQlDDM kSnqYR fgiDpI eeAUEW ecjlX cDxIqC jpWidM jzdNVF bPkdhG bnSwfb fQfkux dPenaT NpaJd jgAayQ fqXcHQ dyMCpl jMYtKl blQfIT lijgUQ ccSWYO eGyfkC hhBXzE iyXZtO jZLyOQ beJoMJ iJgiCW hqUHPA jWWlrr hZGkn chpxwD beuMzX dbtvqd jPcnDC "></i></div><div class="kroOag icKiSN bMSzLf fZMRmg iigETV "><a class="kpaoc bbUXPo dSxtaa cdhcuu " href="/tags/%E5%89%8D%E7%AB%AF/"># <!-- -->前端</a><a class="kpaoc bbUXPo dSxtaa cdhcuu " href="/tags/CSS/"># <!-- -->CSS</a><a class="kpaoc bbUXPo dSxtaa cdhcuu " href="/tags/Atomic-CSS/"># <!-- -->Atomic CSS</a><a class="kpaoc bbUXPo dSxtaa cdhcuu " href="/tags/Tailwind/"># <!-- -->Tailwind</a></div></article><div class="gCwvuy kRQsoY jBvrhX dgtTIu eXJtsk dvivnl llUCyD dPAasc icKiSN bMSzLf fZMRmg iigETV ipEZTh eRVtDl cUXNmd jdraHW biWxPv eqrBPF kooHYa kroOag"><div>喜欢这篇文章？为什么不考虑打赏一下作者呢？</div><a class="cyerGB moyUB lexxaO ebVilo kyhYEz jIkFRm gpptow bbUXPo kMKXDC ftIldC jOeduE iDuqPI cpOcAb eAOGpx " href="https://afdian.net/@baoshuo" target="_blank" rel="noopener noreferrer">爱发电</a></div><div class="gSBWlu ipEZTh eRVtDl cUXNmd jdraHW biWxPv eqrBPF gvwkfp bRNbBj"><div class="gSBWlu dQPgRK eKlQYW bLlOeF fXzCvR klEWBS "><a class="gSBWlu foGVKH dgIPcR kVZHcH cVJMrm iATxZH JxWnH " href="/post/actions-ssl-cert/">使用 GitHub Actions 自动申请与部署 SSL 证书<i class="kUPESX bLHLvQ eLDTYY cjScYX cpOcAb jXmXEB hHGIsI julXB kvHVCE jbzBdl gUiFRX dixaxG jmWgOv bTanCN kSnqYR fgiDpI eeAUEW ecjlX fIXfpL ergVCo cqyuit hCTuXM "></i></a></div></div><div></div></main></div><div class="imhmwA sKExc bjOGUo eSaSrN "><div class="fyuAJJ kQBRAp bcfNhz edKxdA osxXp foquGP lhTVEC kRQsoY jBvrhX dgtTIu eXJtsk cyerGB egGyMq jsvbrX dPAasc "><i class="cpOcAb cjScYX hHGIsI jXmXEB bLHLvQ eLDTYY dhOkuk julXB hCTuXM cqyuit kvHVCE SeaTL kSnqYR jFCJJY iqzSxf bQvqKh "></i></div><a class="fyuAJJ kQBRAp bcfNhz edKxdA osxXp foquGP lhTVEC kRQsoY jBvrhX dgtTIu eXJtsk cyerGB egGyMq jsvbrX dPAasc " href="#"><i class="cpOcAb cjScYX hHGIsI jXmXEB bLHLvQ eLDTYY dhOkuk julXB hCTuXM cqyuit kvHVCE kSnqYR fgiDpI eeAUEW ecjlX SeaTL gjJuRC iWYpgm iHkzF ergVCo jbBqfU fIXfpL "></i></a></div><footer class="eGElBa ftIldC eBrwtd iDuqPI kpaoc gCwvuy kooHYa eAOGpx dPAasc kKplrA jzScEz hMoAFf bccxkr cgjdEA "><div class="kQBRAp kroOag jZOgvY uUxpw "><div>Copyright © 2019 - <!-- -->2022<!-- --> <a class="fyuAJJ jSOKOm cdhcuu kOZsAO " href="/">宝硕博客</a><span class="jTjNVR iawFZL hNjeNG kswRdL gKQCBv "></span><a class="fyuAJJ jSOKOm cdhcuu kOZsAO " href="https://beian.miit.gov.cn" target="_blank" rel="noopener noreferer nofollow">冀ICP备15024669号-3</a></div><div>Powered by<!-- --> <a class="laXLGQ jSOKOm cdhcuu " href="https://nextjs.org" target="_blank" rel="noopener noreferer nofollow">Next.js</a> &amp; <a class="laXLGQ jSOKOm cdhcuu " href="https://hexo.io" target="_blank" rel="noopener noreferer nofollow">Hexo</a><span class="jTjNVR iawFZL hNjeNG kswRdL gKQCBv "></span>Theme by<!-- --> <a class="laXLGQ jSOKOm cdhcuu " href="https://baoshuo.ren" target="_blank">Baoshuo</a></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"拥抱 Atomic CSS-in-JS - 宝硕博客","post":{"title":"拥抱 Atomic CSS-in-JS","excerpt":"当下，Atomic CSS 愈发受到人们的关注。相比于传统 CSS 编写方法中每个组件对应一个 CSS 类，使用了 Atomic CSS 以后，每一个 CSS 类都唯一对应了一条独立的 CSS 规则，随着组件数量逐渐增加、能复用的 CSS 规则越来越多，最终的 CSS 产物体积也会下降许多，使得网页的加载速度能够产生一个质的飞跃。","content":[["$","p",{},["当下，Atomic CSS 愈发受到人们的关注。相比于传统 CSS 编写方法中每个组件对应一个 CSS 类，使用了 Atomic CSS 以后，每一个 CSS 类都唯一对应了一条独立的 CSS 规则，随着组件数量逐渐增加、能复用的 CSS 规则越来越多，最终的 CSS 产物体积也会下降许多，使得网页的加载速度能够产生一个质的飞跃。"]],["$","span",{"id":"more"},[]],["$","h2",{"id":"css-编写方法的发展历程"},["CSS 编写方法的发展历程"]],["$","p",{},["在介绍 Atomic CSS 之前，让我们先来回顾一下 CSS 编写方法的发展历程。"]],["$","h3",{"id":"smacss"},["SMACSS"]],["$","p",{},[["$","a",{"href":"http://smacss.com","rel":"external nofollow noreferrer"},["SMACSS"]],"（Scalable \u0026 Modular Architecture for CSS），是由 Jonathan Snook 提出的 CSS 理论。其主要原则有 3 条："]],["$","ul",{},[["$","li",{},["Categorizing CSS Rules（为 CSS 分类）"]],["$","li",{},["Naming Rules（命名规则）"]],["$","li",{},["Minimizing the Depth of Applicability（最小化适配深度）"]]]],["$","h4",{"id":"规则分类"},["规则分类"]],["$","p",{},["SMACSS 将规则分为了五类：Base（基础）、Layout（布局）、Module（模块）、State（状态）、Theme（主题）。"]],["$","p",{},[["$","strong",{},["基础（Base）"]]," 规则里放置默认样式。这些默认样式基本上都是元素选择器，不过也可以包含属性选择器，伪类选择器，孩子选择器，兄弟选择器。本质上来说，一个基础样式定义了元素在页面的任何位置应该是怎么样的。"]],["$","p",{},[["$","strong",{},["布局（Layout）"]]," 规则将页面拆分成几个部分，每个部分都可能有一到多个模块。顾名思义，这个分类主要用来做页面的整体或其中一块区域的布局。"]],["$","p",{},[["$","strong",{},["模块（Modules）"]]," 是我们的设计当中可重用，可模块化的部分。插图，侧边栏，文章列表等等都属于模块。"]],["$","p",{},[["$","strong",{},["状态（State）"]]," 规则定义了我们的模块或者布局在特殊的状态下应该呈现怎样的效果。它可能定义模块、布局在不同显示屏上应该如何显示。也可能定义一个模块在不同页面（例如主页和内页）中可能呈现怎么样的效果。"]],["$","p",{},[["$","strong",{},["主题（Theme）"]]," 规则和状态规则类似，定义模块或者布局的外观。很多网站的「深色模式」「换肤」等等功能就是这样实现的。"]],["$","h4",{"id":"命名规则"},["命名规则"]],["$","p",{},["将规则分成五类之后，还需要命名规范。命名规范能够使得我们立刻了解到某个样式属于哪一类，以及它在整个页面中起到的作用。在一个大型项目中，我们可能会将一个样式分割成几个文件，这个时候命名约定能够使得我们更容易知道这个样式属于哪个文件。"]],["$","p",{},["推荐使用前缀来区分布局、模块和状态等等规则。比如对布局规则使用 ",["$","code",{},["layout-"]]," 前缀，对状态规则使用 ",["$","code",{},["is-"]]," 前缀就说一个不错的选择。"]],["$","h4",{"id":"最小化适配深度"},["最小化适配深度"]],["$","p",{},["尽量不要依赖文档树的结构来编写样式。这样可以让我们的样式更加灵活，并且容易维护。"]],["$","h3",{"id":"bem"},["BEM"]],["$","p",{},[["$","a",{"href":"http://getbem.com","rel":"external nofollow noreferrer"},["BEM"]],"（ Block Element Modifier）是由 Yandex 团队提出的一种前端 CSS 命名方法论。它是一个简单又非常有用的命名约定。让前端代码更容易阅读和理解，更容易协作，更容易控制，更加健壮和明确，而且更加严密。"]],["$","p",{},["BEM 命名约定的模式是："]],["$","pre",{},[["$","code",{"class":"hljs css"},[["$","span",{"class":"hljs-selector-class"},[".block"]]," {\n}\n\n",["$","span",{"class":"hljs-selector-class"},[".block__element"]]," {\n}\n\n",["$","span",{"class":"hljs-selector-class"},[".block--modifier"]]," {\n}"]]]],["$","ul",{},[["$","li",{},[["$","code",{},["block"]]," 代表了「块」，用于组件本体。"]],["$","li",{},[["$","code",{},["element"]]," 代表了「块」中的某个「元素」（也可以叫做「子组件」），是块构成的主要成员。"]],["$","li",{},[["$","code",{},["modifier"]]," 代表了「块」的修饰符，表示不同的状态和版本。使用 ",["$","code",{},["--"]]," 做区分，适用于「块」和「元素」，分别称之为「块修饰符」和「元素修饰符」。"]]]],["$","p",{},["命名的不同部分之间之所以使用 ",["$","code",{},["__"]]," 和 ",["$","code",{},["--"]]," 分割，是因为如果某部分中如果出现了多个单词需要使用 ",["$","code",{},["-"]]," 分隔，这样可以避免造成混淆。"]],["$","h3",{"id":"css-modules"},["CSS Modules"]],["$","p",{},["随着时代的发展，一个大型前端工程中的 CSS 类名越来越多，此时难免会出现类名冲突的情况，此时 CSS Modules 应运而生 —— 它通过为 CSS 类名添加 Hash 等方式来产生唯一的名称来防止冲突的产生。"]],["$","p",{},[["$","a",{"href":"https://github.com/css-modules/css-modules","rel":"external nofollow noreferrer"},["CSS Modules"]]," 并不是 CSS 官方的标准，也不是浏览器的特性，而是使用一些构建工具，比如 Webpack，对 CSS 类名和选择器限定作用域的一种方式。"]],["$","h3",{"id":"utility-first-css"},["Utility-First CSS"]],["$","p",{},["当传统大型项目使用的 CSS 方法论还都大多是上方提到的 OOCSS、SMACSS、BEM 等等主要聚焦在「关注点分离」的「语义化 CSS」方案的时候，Utility-First 的 CSS 概念脱颖而出、逐渐受到社区的关注。而这之中最为被人熟知的、也最典型的就是 ",["$","a",{"href":"https://tailwindcss.com","rel":"external nofollow noreferrer"},["Tailwind CSS"]]," 了。"]],["$","p",{},["Utility-First CSS 不像 Semantic CSS 那样将组件样式放在一个类中，而是为我们提供一个由不同功能类组成的工具箱，我们可以将它们混合在一起应用在页面元素上。这样有几个好处："]],["$","ul",{},[["$","li",{},["不用纠结于类名的命名；"]],["$","li",{},["功能越简单的类，复用率越高，可以减小最终的打包大小；"]],["$","li",{},["不存在全局样式污染问题；"]],["$","li",{},["等等。"]]]],["$","p",{},["但也存在一些不足："]],["$","ul",{},[["$","li",{},[["$","code",{},["class"]]," 属性的内容过长；"]],["$","li",{},["存在 CSS 规则插入顺序相关的问题；"]],["$","li",{},["不能通过语义化类名得知组件的作用；"]],["$","li",{},["不压缩的话构建产物体积过大。"]]]],["$","h2",{"id":"新时代，来临了-——-atomic-css-in-js"},["新时代，来临了 —— Atomic CSS-in-JS"]],["$","p",{},["在前文介绍的 Utility-First CSS 的基础之上更进一步，Atomic CSS 便映入了人们的眼帘。"]],["$","p",{},["Atomic CSS 背后的思想与以往的「关注点分离」的思想可以称得上是背道而驰了。使用 Atomic CSS 时实际上将结构层和样式层耦合在了一起，这样的方式在现代 CSS-in-JS 的代码库中基本上得到了广泛认可，下文将会进行进一步的介绍。"]],["$","p",{},["Atomic CSS 可以看作是 Utility-First CSS 的极致抽象版本，每一个 CSS 类都对应一条单一的 CSS 规则。可面对如此繁复的 CSS 规则，手写 Atomic CSS 的类名并不是一个好的办法。于是 Atomic CSS-in-JS 应运而生，它可以看作是「自动化的 Atomic CSS」："]],["$","ul",{},[["$","li",{},["无需手动设计 CSS 类名；"]],["$","li",{},["能够提取页面的关键 CSS，并进行代码拆分；"]],["$","li",{},["可以解决经典的 CSS 规则插入顺序的问题。"]]]],["$","h3",{"id":"传统-css-编写方式的缺点"},["传统 CSS 编写方式的缺点"]],["$","p",{},["Christopher Chedeau 一直致力于推广 React 生态系统中 CSS-in-JS 理念。在很多次演讲中，他都解释了 CSS 的几大问题："]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2022/07/23/5PTlQWfhkVZObpJ.png","alt":"","loading":"lazy"},[]]]],["$","ol",{},[["$","li",{},["全局命名空间"]],["$","li",{},["依赖"]],["$","li",{},["无用代码消除"]],["$","li",{},["代码压缩"]],["$","li",{},["共享常量"]],["$","li",{},["非确定性（Non-Deterministic）解析"]],["$","li",{},["隔离"]]]],["$","p",{},["虽然 Utility-First CSS 和 Atomic CSS 也解决了其中的一些问题，但它们无法解决所有问题（特别是样式的非确定性解析）。"]],["$","p",{},["举个例子：Tailwind CSS 会在生成时生成出来许多无用代码，导致样式文件体积的增长，看看下面这份代码："]],["$","pre",{},[["$","code",{"class":"hljs html"},[["$","span",{"class":"hljs-tag"},["\u003c",["$","span",{"class":"hljs-name"},["div"]]," ",["$","span",{"class":"hljs-attr"},["class"]],"=",["$","span",{"class":"hljs-string"},["\"before:bg-white before:p-4\""]],"\u003e"]],"content",["$","span",{"class":"hljs-tag"},["\u003c/",["$","span",{"class":"hljs-name"},["div"]],"\u003e"]]]]]],["$","p",{},["生成出来的样式文件长这个样子："]],["$","pre",{},[["$","code",{"class":"hljs css"},[["$","span",{"class":"hljs-selector-class"},[".before"]],"\\:bg-white::before {\n  ",["$","span",{"class":"hljs-attribute"},["content"]],": ",["$","span",{"class":"hljs-built_in"},["var"]],"(--tw-content);\n  ",["$","span",{"class":"hljs-attr"},["--tw-bg-opacity"]],": ",["$","span",{"class":"hljs-number"},["1"]],";\n  ",["$","span",{"class":"hljs-attribute"},["background-color"]],": ",["$","span",{"class":"hljs-built_in"},["rgb"]],"(",["$","span",{"class":"hljs-number"},["255"]]," ",["$","span",{"class":"hljs-number"},["255"]]," ",["$","span",{"class":"hljs-number"},["255"]]," / ",["$","span",{"class":"hljs-built_in"},["var"]],"(--tw-bg-opacity));\n}\n\n",["$","span",{"class":"hljs-selector-class"},[".before"]],"\\:p-",["$","span",{"class":"hljs-number"},["4"]],"::before {\n  ",["$","span",{"class":"hljs-attribute"},["content"]],": ",["$","span",{"class":"hljs-built_in"},["var"]],"(--tw-content);\n  ",["$","span",{"class":"hljs-attribute"},["padding"]],": ",["$","span",{"class":"hljs-number"},["1rem"]],";\n}"]]]],["$","p",{},["可以看到这份文件中包括了许多的无用代码，比如重复的 ",["$","code",{},["content: var(--tw-content)"]],"。"]],["$","h3",{"id":"更小的构建产物"},["更小的构建产物"]],["$","p",{},["传统的 CSS 编写方法无法复用组件间重复的 CSS 规则，比如下图中高亮的几条规则各自躺在它们对应的 CSS 类中："]],["$","p",{},[["$","img",{"src":"https://arina.loli.net/2022/07/23/TKvwu6PpgxalrsG.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["这样会导致 CSS 产物大小与项目的复杂程度和组件数量线性正相关。"]],["$","p",{},["但使用 Atomic CSS 之后，这些规则被提取出来进行复用："]],["$","p",{},[["$","img",{"src":"https://arina.loli.net/2022/07/23/xKRoETDVqQBgFcf.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["随着后期组件数量逐渐增加、能复用的 CSS 规则越来越多、最终 CSS 产物大小与项目复杂程度呈对数关系："]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2022/07/16/Uq6nbJXidShyzH8.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["Facebook 分享了他们的数据：在旧网站上，仅登录页就需要加载 413 KiB 的样式文件，而在使用 Atomic CSS-in-JS 重写后，整个站点只有 74 KiB 的样式文件，还包括了深色模式。"]],["$","p",{},["虽然在使用 Atomic CSS 之后，HTML 的体积会显著增大，不过由于这些类名的高冗余度，可以利用 gzip 来压缩掉很大一部分体积。"]],["$","h3",{"id":"处理-css-规则的插入顺序"},["处理 CSS 规则的插入顺序"]],["$","p",{},["让我们再来回顾一遍这个经典的 CSS 规则插入顺序的问题："]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2022/07/23/dfu1NqZ7i3pmOrM.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["我们都知道，最后生效的样式不是最后一个类名对应的规则，而是样式表中最后插入的规则。"]],["$","p",{},["那么，如何在 CSS-in-JS 中处理这个问题呢？通用的做法是在生成阶段就将冲突的规则过滤掉，以避免产生冲突。比如下面这个组件："]],["$","pre",{},[["$","code",{"class":"hljs js"},[["$","span",{"class":"hljs-keyword"},["const"]]," styles = style9.",["$","span",{"class":"hljs-title function_"},["create"]],"({\n  ",["$","span",{"class":"hljs-attr"},["card"]],": {\n    ",["$","span",{"class":"hljs-attr"},["marginTop"]],": ",["$","span",{"class":"hljs-string"},["'10px'"]],",\n    ",["$","span",{"class":"hljs-attr"},["marginBottom"]],": ",["$","span",{"class":"hljs-string"},["'10px'"]],",\n  },\n  ",["$","span",{"class":"hljs-attr"},["profileCard"]],": {\n    ",["$","span",{"class":"hljs-attr"},["marginBottom"]],": ",["$","span",{"class":"hljs-string"},["'20px'"]],",\n  },\n});\n\n",["$","span",{"class":"hljs-keyword"},["const"]]," ",["$","span",{"class":"hljs-title function_"},["Component"]]," = (",["$","span",{"class":"hljs-params"},[]],") =\u003e (\n  ",["$","span",{"class":"language-xml"},[["$","span",{"class":"hljs-tag"},["\u003c",["$","span",{"class":"hljs-name"},["div"]]," ",["$","span",{"class":"hljs-attr"},["className"]],"=",["$","span",{"class":"hljs-string"},["{style9(styles.card,"]]," ",["$","span",{"class":"hljs-attr"},["styles.profileCard"]],")} /\u003e"]]]],"\n);"]]]],["$","p",{},["过滤后组件的实际样式如下："]],["$","pre",{},[["$","code",{"class":"hljs css"},[["$","span",{"class":"hljs-attribute"},["margin-top"]],": ",["$","span",{"class":"hljs-number"},["10px"]],";\n",["$","span",{"class":"hljs-attribute"},["margin-bottom"]],": ",["$","span",{"class":"hljs-number"},["20px"]],";"]]]],["$","p",{},["但 CSS 中有一些简写规则，如果只按照规则名称来处理显然是不行的。有的库强制开发者们不使用简写规则来避免这个问题，而另外的一些库则将这些简写规则展开成多条规则后再进行过滤，比如 ",["$","code",{},["margin: 10px"]]," 可以被拆成 ",["$","code",{},["margin-top: 10px"]],"、",["$","code",{},["margin-right: 10px"]],"、",["$","code",{},["margin-bottom: 10px"]],"、",["$","code",{},["margin-left: 10px"]]," 四条独立的规则。"]],["$","h3",{"id":"经典实现"},["经典实现"]],["$","p",{},["Atomic CSS-in-JS 实现有运行时（Runtime）和预编译（Pre-Compile）两种。"]],["$","h4",{"id":"运行时（runtime）"},["运行时（Runtime）"]],["$","p",{},[["$","a",{"href":"https://styletron.org","rel":"external nofollow noreferrer"},["Styletron"]]," 是 Uber 公司开发的一个较为典型的运行时 Atomic CSS-in-JS 库，驱动了 Uber 的官网和 H5 页面。其优点在于可以动态生成样式，相比于下文中采用预编译方法的库来说灵活度高了不止一点半点。其缺点则在于 Vendor Prefix 等操作需要在 Runtime 执行，因此 Bundle 中必须携带相关依赖导致体积增大。与其相类似的还有沃尔沃汽车前技术主管的 ",["$","a",{"href":"https://fela.js.org/","rel":"external nofollow noreferrer"},["Fela"]],"（驱动了沃尔沃汽车官网，Cloudflare Dashboard 和 Medium 等众多网站），在此不做过多叙述，感兴趣的读者可以自行了解。"]],["$","h4",{"id":"预编译（pre-compile）"},["预编译（Pre-Compile）"]],["$","p",{},[["$","a",{"href":"https://www.youtube.com/watch?v=9JZHodNR184","rel":"external nofollow noreferrer"},["Stylex"]]," 是 Meta（原 Facebook）的一个尚未开源的预编译 Atomic CSS-in-JS 库。其优点在于无需将相关依赖打包发送给客户端，改善了性能。而缺点则是预编译的过程高度依赖静态代码分析，所以难以实现动态样式生成与组合。不过由于 Meta 迟迟不开源 stylex，社区中已经涌现出了数个基于其思想的开源实现，以 ",["$","a",{"href":"https://github.com/seek-oss/vanilla-extract","rel":"external nofollow noreferrer"},["vanilla-extract"]]," 最为知名，除此之外还有 ",["$","a",{"href":"https://github.com/johanholmerin/style9","rel":"external nofollow noreferrer"},["style9"]],"、",["$","a",{"href":"https://github.com/necolas/styleq","rel":"external nofollow noreferrer"},["styleQ"]]," 等等。"]],["$","p",{},["将视线从 stylex 上转移开来，Atlassian 还编写了一个名为 ",["$","a",{"href":"https://compiledcssinjs.com/","rel":"external nofollow noreferrer"},["compiled"]]," 的预编译 Atomic CSS-in-JS 库，但在笔者的实际使用过程中坑点较多，可能会导致样式的重复生成，并且其对 TypeScript 的支持也不尽人意，遂弃之。"]],["$","h4",{"id":"其他"},["其他"]],["$","p",{},["微软最近开源的 ",["$","a",{"href":"https://github.com/microsoft/griffel","rel":"external nofollow noreferrer"},["Griffel"]]," 既支持运行时模式，又支持预编译模式，同时拥有着更佳的 TypeScript 支持，不失为一个好的选择。这个库目前驱动了微软官方的 ",["$","a",{"href":"https://developer.microsoft.com/en-us/fluentui","rel":"external nofollow noreferrer"},["Fluent UI"]],"。"]],["$","h2",{"id":"后记"},["后记"]],["$","p",{},["以上就是本文要介绍关于 Atomic CSS 的全部内容了。"]],["$","p",{},["虽然 Atomic CSS-in-JS 是 React 生态系统中新涌起的一股潮流，但在使用前一定要三思 —— 这个方案到底符不符合项目的需求，而不是盲目地「为了使用而使用」，给将来的维护工作埋雷，但如果使用它能带来显而易见的好处，那么何乐而不为呢？"]],["$","p",{},["笔者才疏学浅，只是在前人的基础之上做了一些微小的工作而已，文章中如有错误欢迎在评论区指正。感谢 ",["$","a",{"href":"https://skk.moe","rel":"external nofollow noreferrer"},["Sukka"]]," 大佬在本文编写过程中的指导。"]],["$","h2",{"id":"参考资料-2"},["参考资料"]],["$","ol",{},[["$","li",{},[["$","a",{"href":"https://sebastienlorber.com/atomic-css-in-js","rel":"external nofollow noreferrer"},["Atomic CSS-in-JS"]],"，Sébastien Lorber，2020 年 4 月 27 日。"]],["$","li",{},[["$","a",{"href":"https://mongkii.com/blog/2021-07-26-talk-about-atomic-css","rel":"external nofollow noreferrer"},["聊聊原子类（Atomic CSS）"]],"，Mongkii，2021 年 7 月 26 日。"]],["$","li",{},[["$","a",{"href":"http://acgtofe.com/posts/2014/09/valuable-theories-of-css","rel":"external nofollow noreferrer"},["值得参考的 CSS 理论：OOCSS、SMACSS 与 BEM"]],"，ACGTOFE，2014 年 9 月 30 日。"]],["$","li",{},[["$","a",{"href":"https://tailwindcss.com/docs/utility-first","rel":"external nofollow noreferrer"},["Utility-First Fundamentals"]],"，Tailwind CSS。"]]]]],"thumb":"https://s1.baoshuo.ren/2022/07/23/R2LQrmhBxc3PEFy.webp","date":"2022-07-23","updated":"2022-07-23","isoDate":"2022-07-23T09:30:29.000Z","isoUpdate":"2022-07-23T10:44:10.000Z","categories":[{"name":"技术向","url":"/categories/%E6%8A%80%E6%9C%AF%E5%90%91/"}],"tags":[{"name":"前端","url":"/tags/%E5%89%8D%E7%AB%AF/"},{"name":"CSS","url":"/tags/CSS/"},{"name":"Atomic CSS","url":"/tags/Atomic-CSS/"},{"name":"Tailwind","url":"/tags/Tailwind/"}],"license":null,"permalink":"https://blog.baoshuo.ren/post/atomic-css-in-js/","url":"/post/atomic-css-in-js/","prev":null,"next":{"title":"使用 GitHub Actions 自动申请与部署 SSL 证书","url":"/post/actions-ssl-cert/"},"toc":{"0":{"0":{"0":{"text":"规则分类","id":"规则分类"},"1":{"text":"命名规则","id":"命名规则"},"2":{"text":"最小化适配深度","id":"最小化适配深度"},"text":"SMACSS","id":"smacss"},"1":{"text":"BEM","id":"bem"},"2":{"text":"CSS Modules","id":"css-modules"},"3":{"text":"Utility-First CSS","id":"utility-first-css"},"text":"CSS 编写方法的发展历程","id":"css-编写方法的发展历程"},"1":{"0":{"text":"传统 CSS 编写方式的缺点","id":"传统-css-编写方式的缺点"},"1":{"text":"更小的构建产物","id":"更小的构建产物"},"2":{"text":"处理 CSS 规则的插入顺序","id":"处理-css-规则的插入顺序"},"3":{"text":"经典实现","id":"经典实现"},"text":"新时代，来临了 —— Atomic CSS-in-JS","id":"新时代，来临了-——-atomic-css-in-js"},"2":{"text":"后记","id":"后记"},"3":{"text":"参考资料","id":"参考资料-2"}},"hasToc":true,"comments":true,"wordCount":"约 3.1 千字"}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"atomic-css-in-js"},"buildId":"1i1kdh5SS5WHuE0jHcfjV","assetPrefix":"https://static.cdn.baoshuo.ren/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>