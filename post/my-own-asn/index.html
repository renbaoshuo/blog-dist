<!-- Baoshuo's Blog | Build: d3efa44 | Baoshuo ( https://baoshuo.ren ) -->
<!DOCTYPE html><html lang=zh-cn><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>年轻人的第一个 ASN - 宝硕博客</title><link rel=icon href=https://cdn.jsdelivr.net/npm/bsi@0.0.4/favicon/16x16.png><link rel=preconnect href=https://cdn.jsdelivr.net><link rel=preconnect href=https://vip1.loli.io><link rel=preconnect href=https://vip2.loli.io><link rel=preload href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap"></noscript><link rel=alternate href=/rss.xml title=宝硕博客 type=application/rss+xml><link rel=alternate href=/atom.xml title=宝硕博客 type=application/atom+xml><style>*,::after,::before{box-sizing:border-box}html{line-height:1.15;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{margin:0;font-family:system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji'}hr{height:0;color:inherit}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}legend{padding:0}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}:root{--bg:#ffffff;--bg-c:#f8f9fa;--bg-b:#eeeeee;--bg-h:#00000010;--text:#343a40;--mtext:#949b9e;--code:#1b1f230d;--border:#dfe2e5;--accent:#3273dc;--fab:#f5f5f5;--alt:#e6e8ee;--br:10px;--shadow:0 4px 10px rgba(0, 2, 4, 0.06),0 0 1px rgba(0, 2, 4, 0.11);--my:0.75rem 0;--mt:1rem 0 0 0;--pc:1.5rem 2rem}@media (prefers-color-scheme:dark){:root:not(.light){--bg:#151617;--bg-c:#1d1e1f;--bg-b:#3b3d3f;--bg-h:#ffffff27;--text:#e0eaef;--mtext:#7c8183;--border:#7c8183;--code:#ffffff0d;--fab:#393939;--alt:#3e4b5e}}.dark{--bg:#151617;--bg-c:#1d1e1f;--bg-b:#3b3d3f;--bg-h:#ffffff27;--text:#e0eaef;--mtext:#7c8183;--border:#646464;--code:#ffffff0d;--fab:#393939;--alt:#3e4b5e}:root{color-scheme:light;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.dark{color-scheme:dark}iframe{color-scheme:light}*,:after,:before{margin:0;padding:0}:focus{outline-width:0}:focus-visible{outline-width:1px}html{font-family:-apple-system,system-ui,BlinkMacSystemFont,'Segoe UI',Roboto,'PingFang SC','Hiragino Sans GB','Source Han Sans SC','Noto Sans CJK SC','Microsoft YaHei','WenQuanYi Micro Hei','WenQuanYi Zen Hei','Helvetica Neue',Arial,sans-serif;color:var(--text);background:var(--bg);font-size:16px;letter-spacing:.75px;transition:all .3s;line-height:1.5;-webkit-text-size-adjust:100%}button{outline:0}a{text-decoration:none;color:var(--accent)}a,body,div,h1,h2,h3,h4,h5,h6,li,ol,p,table,td,tr,ul{box-sizing:border-box;margin:0;padding:0}ol li{list-style:decimal}ul li{list-style:disc}hr{margin:1rem 0;border:0;border-top:1px solid rgba(0,0,0,.1)}.dark hr{border-top:1px solid rgba(255,255,255,.1)}.container{display:flex;margin:0 auto;max-width:100%;min-height:100vh;width:1000px;flex-direction:column;justify-content:space-between}@media (max-width:1023px){.container{width:100%}}main{display:flex;flex-direction:column;padding:0 .5rem}.divider{border-top:.05rem solid var(--alt);height:.05rem;margin:.6rem 0}.hidden{display:none}.dot{margin:0 .2rem}.dot::after{content:'·'}.card{border-radius:var(--br);background:var(--bg-c);box-shadow:var(--shadow)}.flex{display:flex;flex:1}.flex-column{flex-direction:column}.button{-webkit-appearance:none;-moz-appearance:none;appearance:none;align-items:center!important;border:1px solid transparent!important;box-shadow:none;display:inline-flex;font-size:.875rem;padding:15px 20px;height:32px;line-height:1.5;box-sizing:border-box;cursor:pointer;border-radius:4px}.navbar{display:flex;flex-wrap:wrap;justify-content:space-between;width:100%;padding:2.25rem .75rem;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}@media (min-width:1024px){.navbar{flex-flow:row nowrap;justify-content:flex-start}}@media (max-width:1023px){.navbar{width:100%;padding:1.875rem 1.875rem .75rem 1.875rem}}.navbar-brand{display:flex;flex-direction:row;align-items:center;font-size:1.25rem;line-height:inherit;white-space:nowrap}.navbar-brand:focus,.navbar-brand:hover{text-decoration:none}.site-logo{width:32px;height:32px}@media (max-width:1023px){.site-logo{width:30px;height:30px}}.site-name{font-size:1.5rem;font-weight:700;margin-left:.75rem;display:inline-block;letter-spacing:2px;color:var(--text)}@media (max-width:1023px){.site-name{font-size:1.25rem}}.navbar-nav{width:100%;display:flex;flex-direction:row;justify-content:flex-end;padding-left:0;margin-bottom:0;align-items:center}@media (max-width:767px){.navbar-nav{flex-direction:column}}@media (max-width:1023px) and (min-width:768px){.navbar-nav{justify-content:space-between}}.nav-item{padding:.875rem 1.625rem}@media (max-width:767px){.nav-item{padding:1rem 1.5rem}.nav-item:first-child{margin-top:.75rem}}@media (min-width:1024px){.nav-item:last-child{padding-right:.625rem}}.nav-item a{font-size:.925rem;flex-shrink:0;color:var(--text)}.navbar-collapse{flex-basis:100%;flex-grow:1;align-items:center}@media (min-width:1024px){.navbar-collapse{display:flex;flex-basis:auto}}.navbar-toggler{padding:.25rem .75rem;font-size:1.25rem;line-height:1;background-color:transparent;border:1px solid transparent;border-radius:.25rem;cursor:pointer;color:var(--text)}@media (min-width:1024px){.navbar-toggler{display:none}}.navbar-toggler:focus,.navbar-toggler:hover{text-decoration:none}@media (max-width:1023px){#navbarSupportedContent{display:none}}.footer{display:flex;width:100%;justify-content:space-between;margin:0 auto;font-size:.75em;padding:1.5rem 0}@media (max-width:1023px){.footer{width:calc(100% - 3rem);flex-direction:column}}.footer a{color:var(--text)}.fab{position:fixed;bottom:3rem;right:1.5rem;contain:layout}.fab .fab-btn{-webkit-appearance:none;-moz-appearance:none;appearance:none;align-items:center;margin-top:.5rem;font-size:.75rem;background-color:var(--fab);display:flex;padding:1rem;box-shadow:0 .3rem .5rem rgba(48,55,66,.15);border:none;border-radius:1rem;line-height:1;color:var(--text)}.pagination-container{display:flex;padding:1rem 1.5rem;align-self:center;flex-wrap:wrap;flex-grow:1;flex-shrink:1}.pagination-container .extend,.pagination-container .page-number,.pagination-container .space{color:var(--text);background:var(--bg-c);border-radius:.5rem;padding:.5rem;margin:0 .5rem;min-width:1.25em;justify-content:center;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:content-box;box-shadow:var(--shadow)}.pagination-container .space{color:var(--mtext)}.pagination-container .current{color:var(--bg-c);background:var(--text)}.pagination-container .extend{margin:0 1rem}</style><script>window.ga_tid="UA-213405558-2",window.ga_api="https://api.baoshuo.ren/cfga/jquery.js"</script><script src=/scripts/cfga.js async></script><meta name=theme-color content=#fff id=theme-color><script inline>"use strict";!function(e){function t(e){try{return localStorage.getItem(e)}catch(e){return null}}function r(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function n(){c.classList.remove(l),c.classList.remove(d[l]),m(i)}function o(e){(e=e||t(i))===r()?(n(),a.content=u[e]):s[e]?(c.classList.add(e),a.content=u[e],c.classList.remove(d[e])):n()}var c=e.documentElement,a=e.getElementById("theme-color"),l="dark",i="user-color-scheme",s={dark:!0,light:!0},d={dark:"light",light:"dark"},u={dark:"#151617",light:"#fff"},m=function(e){try{localStorage.removeItem(e)}catch(e){console.error(e)}};o(),e.addEventListener("DOMContentLoaded",(function(){e.getElementById("toggleDarkMode").addEventListener("click",(function(){return o(function(){var e=t(i);if(s[e])e=d[e];else{if(null!==e)return;e=d[r()]}return function(e,t){try{localStorage.setItem(e,t)}catch(e){console.error(e)}}(i,e),e}())}))}))}(document)</script><meta itemprop=name content="年轻人的第一个 ASN - 宝硕博客"><meta itemprop=image content=https://vip2.loli.io/2021/02/28/XMjiBGVdHmARW48.png><meta itemprop=description content="很久之前就有了这样的一个想法：拥有一个自己的 ASN 。2021 年的寒假末尾，我终于找到了一个肯给我这个未成年人申请 ASN 的 LIR 。
于是这个世界上又多了一个祸害公网的人。"><meta name=keywords content="宝硕,Baoshuo,Ren Baoshuo,@renbaoshuo,@baoshuo,Blog,Web,Hexo,自动化,GitHub Actions,Vercel,Netlify,Cloudflare,CTF,Hackergame,Web,HTTP,JavaScript,Linux,VMware,Cloudflare,Linux,BIRD,BGP,DN42,BGP,DN42,BGP"><meta name=description content="很久之前就有了这样的一个想法：拥有一个自己的 ASN 。2021 年的寒假末尾，我终于找到了一个肯给我这个未成年人申请 ASN 的 LIR 。 于是这个世界上又多了一个祸害公网的人。"><meta property=og:type content=article><meta property=og:title content="年轻人的第一个 ASN - 宝硕博客"><meta property=og:url content=https://blog.baoshuo.ren/post/my-own-asn/ ><meta property=og:site_name content=宝硕博客><meta property=og:description content="很久之前就有了这样的一个想法：拥有一个自己的 ASN 。2021 年的寒假末尾，我终于找到了一个肯给我这个未成年人申请 ASN 的 LIR 。 于是这个世界上又多了一个祸害公网的人。"><meta property=og:locale><meta property=og:image content=https://vip2.loli.io/2021/02/28/XMjiBGVdHmARW48.png><meta property=article:published_time content=2021-03-20T17:06:09.000Z><meta property=article:modified_time content=2021-03-20T17:06:09.000Z><meta property=article:author content=宝硕><meta property=article:tag content=BGP><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=https://vip2.loli.io/2021/02/28/XMjiBGVdHmARW48.png><meta name=twitter:creator content=@renbaoshuo><meta name=twitter:site content=renbaoshuo><link rel=canonical href=https://blog.baoshuo.ren/post/my-own-asn/ ><link rel=search href=/opensearch.xml title=宝硕博客 type=application/opensearchdescription+xml><script>navigator.serviceWorker&&window.addEventListener("load",(function(e){navigator.serviceWorker.register("/sw.js")}))</script><script>console.log("%c Baoshuo's Blog %c d3efa44 %c","background: #35495e; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background: #3273dc; padding: 1px; border-radius: 0 3px 3px 0; color: #fff;","background: transparent;")</script><meta name=baidu-site-verification content=code-zj5xUet4IJ><meta name=generator content="Hexo 5.4.0"></head><body><div class=container><header class="navbar navbar-expand-lg"><a class=navbar-brand href=/ ><img class=site-logo src=https://cdn.jsdelivr.net/npm/bsi@0.0.4/favicon/64x64.png alt=Avatar><div class=site-name>宝硕博客</div></a><button aria-label="Navbar Toggler" class=navbar-toggler type=button id=changeNavbar><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512" height=18px fill=currentColor><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></button><div class="collapse navbar-collapse" id=navbarSupportedContent><div class=navbar-nav><div class=nav-item><a href=/ class="menu gt-a-link">首页</a></div><div class=nav-item><a href=/archives/ class="menu gt-a-link">归档</a></div><div class=nav-item><a href=/categories/ class="menu gt-a-link">分类</a></div><div class=nav-item><a href=/tags/ class="menu gt-a-link">标签</a></div><div class=nav-item><a href=/friends/ class="menu gt-a-link">友链</a></div><div class=nav-item><a href=/about/ class="menu gt-a-link">关于</a></div><div class=nav-item style="padding:1.0625rem 1.25rem .6875rem 1.25rem"><a href=/search/ class=menu><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 512 512" height=16 width=16><path fill=currentColor d="M508.5 468.9L387.1 347.5c-2.3-2.3-5.3-3.5-8.5-3.5h-13.2c31.5-36.5 50.6-84 50.6-136C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c52 0 99.5-19.1 136-50.6v13.2c0 3.2 1.3 6.2 3.5 8.5l121.4 121.4c4.7 4.7 12.3 4.7 17 0l22.6-22.6c4.7-4.7 4.7-12.3 0-17zM208 368c-88.4 0-160-71.6-160-160S119.6 48 208 48s160 71.6 160 160-71.6 160-160 160z"/></svg></a></div><div class=nav-item style="padding:1.0625rem 1.25rem .6875rem 1.25rem"><a href=/atom.xml class=menu><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512" height=16 width=16><path fill=currentColor d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg></a></div><div class=nav-item style="padding:1.0625rem 1.25rem .6875rem 1.25rem"><a id=toggleDarkMode href=javascript:; rel="external nofollow noreferrer" class=menu><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 512 512" height=16 width=16><path fill=currentColor d="M256 56c110.549 0 200 89.468 200 200 0 110.549-89.468 200-200 200-110.549 0-200-89.468-200-200 0-110.549 89.468-200 200-200m0-48C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 96c-83.947 0-152 68.053-152 152s68.053 152 152 152V104z"/></svg></a></div></div></div></header><script>document.getElementById("changeNavbar").onclick=function(){var e=document.getElementById("navbarSupportedContent");"none"===e.style.display||""===e.style.display?e.style.display="block":e.style.display="none"}</script><main><style>.post{margin:var(--my)}.feature{border-radius:var(--br) var(--br) 0 0;background:var(--bg-b);-o-object-fit:cover;object-fit:cover;max-height:400px;display:block;width:100%}@media (max-width:1023px){.feature{max-height:16.48rem}}.feature+.post-container{margin-top:0;border-radius:0 0 var(--br) var(--br)}.dark .feature{-webkit-filter:brightness(.75) contrast(1.25);filter:brightness(.75) contrast(1.25)}.post-container{padding:1.5rem 2rem}.post-title{font-size:1.625rem;text-align:center;padding:1.5rem;font-weight:400;letter-spacing:1.5px}@media (max-width:1023px){.post-title{font-size:1.4rem;font-weight:700}}.post-meta{display:flex;flex-wrap:wrap;justify-content:space-between;font-size:.9rem;padding-bottom:1.5rem;color:var(--mtext)}.post-meta .post-meta-left{display:flex}.post-meta .post-meta-left .category{transition:all .3s}.post-meta .post-tags{align-self:flex-end}.post-meta .post-tags .tag{padding:8px 4px;transition:all .3s}.post-meta a{color:var(--mtext)}.post-meta a:hover{color:var(--accent)}.content{word-break:normal;word-wrap:break-word}.content h1,.content h2,.content h3,.content h4,.content h5,.content h6{margin-bottom:1.25rem;padding-top:.875rem;font-weight:700;letter-spacing:1px}.content h1{font-size:1.75rem}.content h2{font-size:1.5rem}.content h3{font-size:1.25rem}.content h4{font-size:1.125rem}.content h5{font-size:1rem}.content h6{font-size:.875rem}.content img{display:block;max-width:100%;border-radius:calc(var(--br)/ 2);margin:1.25rem auto}.dark .content img{-webkit-filter:brightness(.75) contrast(1.25);filter:brightness(.75) contrast(1.25)}.content p{line-height:1.725;margin-bottom:1.25rem;font-size:1rem;letter-spacing:1.0382px}.content p:last-child{margin-bottom:0}.content blockquote{padding:1rem;border:0;border-left:.25rem;border-style:solid;margin-bottom:1rem;background:var(--bg-b);border-color:var(--accent)}.content blockquote p:last-child{margin-bottom:0}.content li code,.content p code,.content table code{letter-spacing:0;color:var(--text);font-family:'Roboto Mono',Consolas,Menlo,Monaco,'Source Code Pro','Courier New',monospace;padding:.2em .4em;margin:0;font-size:.85em;background-color:var(--code);border-radius:6px;word-break:break-all}.content a{color:var(--accent)}.content a code{color:var(--accent)}.content a:hover{text-decoration:underline}.content a:visited{color:var(--accent)}.content table{border-collapse:collapse;margin:1rem 0;overflow-x:auto;display:block;width:100%}.content table thead th{text-align:left}.content table tr{border-top:1px solid var(--border)}.content table td,.content table th{border:1px solid var(--border);padding:.6em 1em}.content table td img,.content table th img{display:inline-block}.content pre{width:100%;margin-bottom:1.25rem;margin-right:2rem;overflow:hidden;border-radius:calc(var(--br)/ 2);scrollbar-width:thin;scrollbar-color:auto}.content pre>code{letter-spacing:0;font-size:.875rem;font-family:'Roboto Mono',Consolas,Menlo,Monaco,'Source Code Pro','Courier New',monospace;padding:1em;line-height:1.5;position:relative;overflow:scroll;display:block}.content ol,.content ul{margin-left:2.25rem;line-height:1.725;margin-bottom:1rem}.content li>ol,.content li>ul{margin-bottom:0}.content details{background:var(--bg-b);border-radius:calc(var(--br)/ 2);padding:.625rem 1.25rem;margin:.5rem 0}.content details summary{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-size:.875rem;font-weight:700;padding:.625rem 1.25rem;border-radius:5px;background:var(--bg-b);margin:-.625rem -1.25rem}.content details[open] summary{border-radius:5px 5px 0 0;margin:-10px -20px 15px -20px}.content details p{font-size:.875rem}.content cite{font-style:normal;text-align:right;display:block}.content cite::before{content:'——'}#article-expire{padding:1rem 2rem;background-color:#fffbeb;color:#947600;margin:-.5rem -2rem 2rem}.dark #article-expire{background-color:#4f3f00;color:#cac3a2}#english-version{padding:1rem 2rem;margin:-.5rem -2rem 2rem;background-color:#e0f7fa;color:#3e3c3a}.dark #english-version{background-color:#e0f7fa11;color:#cecac3}.license{margin:var(--my);padding:var(--pc);position:relative;overflow:hidden}.license::after{position:absolute;content:' ';height:175px;width:175px;right:-25px;top:-35px;opacity:.25;background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OTYgNTEyIj48cGF0aCBmaWxsPSIjNGE0YTRhIiBkPSJNMjQ1LjggMjE0LjlsLTMzLjIgMTcuM2MtOS40LTE5LjYtMjUuMi0yMC0yNy40LTIwLTIyLjIgMC0zMy4zIDE0LjYtMzMuMyA0My45IDAgMjMuNSA5LjIgNDMuOCAzMy4zIDQzLjggMTQuNCAwIDI0LjYtNyAzMC41LTIxLjNsMzAuNiAxNS41YTczLjIgNzMuMiAwIDAxLTY1LjEgMzljLTIyLjYgMC03NC0xMC4zLTc0LTc3IDAtNTguNyA0My03NyA3Mi42LTc3IDMwLjgtLjEgNTIuNyAxMS45IDY2IDM1Ljh6bTE0MyAwbC0zMi43IDE3LjNjLTkuNS0xOS44LTI1LjctMjAtMjcuOS0yMC0yMi4xIDAtMzMuMiAxNC42LTMzLjIgNDMuOSAwIDIzLjUgOS4yIDQzLjggMzMuMiA0My44IDE0LjUgMCAyNC43LTcgMzAuNS0yMS4zbDMxIDE1LjVjLTIgMy44LTIxLjMgMzktNjUgMzktMjIuNyAwLTc0LTkuOS03NC03NyAwLTU4LjcgNDMtNzcgNzIuNi03N0MzNTQgMTc5IDM3NiAxOTEgMzg5IDIxNC44ek0yNDcuNyA4QzEwNC43IDggMCAxMjMgMCAyNTZjMCAxMzguNCAxMTMuNiAyNDggMjQ3LjYgMjQ4QzM3Ny41IDUwNCA0OTYgNDAzIDQ5NiAyNTYgNDk2IDExOCAzODkuNCA4IDI0Ny42IDh6bS44IDQ1MC44Yy0xMTIuNSAwLTIwMy43LTkzLTIwMy43LTIwMi44IDAtMTA1LjUgODUuNS0yMDMuMyAyMDMuOC0yMDMuM0EyMDEuNyAyMDEuNyAwIDAxNDUxLjMgMjU2YzAgMTIxLjctOTkuNyAyMDIuOS0yMDIuOSAyMDIuOXoiLz48L3N2Zz4=)}.license-title{font-weight:700;margin:0 0 .25rem}.license-link{font-size:.9em;margin-bottom:1rem}.license-link a{color:var(--mtext);text-decoration:underline}.license-meta{display:flex;align-items:center;justify-content:flex-start;flex-wrap:wrap}.license-meta-item{margin:0 2rem 1em 0}.license-meta-title{font-size:.8rem;margin:0 0 .25rem}.license-meta-text{margin:0}.license-meta-text a{color:currentColor}.license-meta-text a:hover{text-decoration:underline;color:var(--accent)}.afdian{margin:1rem 0;margin:var(--my);padding:var(--pc)}.afdian-button{color:#fff;background-color:#946ce6;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;align-self:center}.donation-label{margin-bottom:1rem;letter-spacing:1px;font-size:.875rem}.post-toc{display:none;position:fixed;right:1rem;bottom:1rem;padding:1.5rem;z-index:100;background:var(--bg);box-shadow:0 .3rem .5rem rgba(48,55,66,.15);border-radius:var(--br);max-height:calc(91vh - 5rem)}@media (max-width:1023px){.post-toc{left:0;right:0;margin:1rem}}@media (min-width:1000px){.post-toc{width:400px}}.post-toc.active{display:block}.post-toc .toc-label{font-weight:700;padding-bottom:.75rem;display:flex;justify-content:space-between}.post-toc .toc-label #post-toc-close{padding:0 0 0 .5rem;color:var(--text)}.post-toc .toc{overflow-y:auto;overflow-x:hidden;max-height:calc(91vh - 10rem)}.post-toc .toc .toc-item{list-style:none}.post-toc .toc .toc-item a{display:flex;padding:.5rem .75rem;color:var(--text);transition:all .3s}.post-toc .toc .toc-item a:hover{background:var(--bg-h)}.post-toc .toc .toc-child{border-left:2px solid var(--border);margin:.25rem .75rem;padding-left:.75rem}.pagination-container{display:flex;flex-direction:row;padding:1rem 1.5rem;align-self:center;width:100%;justify-content:space-between}.pagination-container .next-page,.pagination-container .prev-page{display:flex;flex:50% 1;align-items:center;color:var(--mtext)}.pagination-container .next-page a,.pagination-container .prev-page a{color:var(--text)}.pagination-container .prev-page{justify-content:flex-start}.pagination-container .next-page{justify-content:flex-end;text-align:right}.i-next,.i-prev{color:var(--text);font-size:14px;box-sizing:border-box;display:inline-block;width:1em;height:1em;position:relative;text-indent:-9999px;vertical-align:middle}.i-next::before,.i-prev::before{border-style:solid;border-width:2px 2px 0 0;height:.65em;transform:translate(-75%,-50%) rotate(45deg);width:.65em;box-sizing:border-box;content:'';left:50%;position:absolute;top:50%}.i-prev{margin-right:.5rem}.i-prev::before{transform:translate(-25%,-50%) rotate(-135deg)}.i-next{margin-left:.5rem}.dark pre>code{color:#abb2bf;background:#282c34}.dark pre>code .comment,.dark pre>code .quote{color:#5c6370}.dark pre>code .doctag,.dark pre>code .formula,.dark pre>code .keyword{color:#c678dd}.dark pre>code .deletion,.dark pre>code .name,.dark pre>code .section,.dark pre>code .selector-tag,.dark pre>code .subst{color:#e06c75}.dark pre>code .literal{color:#56b6c2}.dark pre>code .addition,.dark pre>code .attribute,.dark pre>code .meta-string,.dark pre>code .regexp,.dark pre>code .string{color:#98c379}.dark pre>code .built_in,.dark pre>code .class .title{color:#e6c07b}.dark pre>code .attr,.dark pre>code .number,.dark pre>code .selector-attr,.dark pre>code .selector-class,.dark pre>code .selector-pseudo,.dark pre>code .template-variable,.dark pre>code .type,.dark pre>code .variable{color:#d19a66}.dark pre>code .bullet,.dark pre>code .link,.dark pre>code .meta,.dark pre>code .selector-id,.dark pre>code .symbol,.dark pre>code .title{color:#61aeee}.dark pre>code::-webkit-scrollbar-thumb{background-color:#cbcbcb!important}.dark pre>code::-webkit-scrollbar-corner,.dark pre>code::-webkit-scrollbar-track-piece{background:#282c34!important}@media (prefers-color-scheme:dark){:root:not(.light) pre>code{color:#abb2bf;background:#282c34}:root:not(.light) pre>code .comment,:root:not(.light) pre>code .quote{color:#5c6370}:root:not(.light) pre>code .doctag,:root:not(.light) pre>code .formula,:root:not(.light) pre>code .keyword{color:#c678dd}:root:not(.light) pre>code .deletion,:root:not(.light) pre>code .name,:root:not(.light) pre>code .section,:root:not(.light) pre>code .selector-tag,:root:not(.light) pre>code .subst{color:#e06c75}:root:not(.light) pre>code .literal{color:#56b6c2}:root:not(.light) pre>code .addition,:root:not(.light) pre>code .attribute,:root:not(.light) pre>code .meta-string,:root:not(.light) pre>code .regexp,:root:not(.light) pre>code .string{color:#98c379}:root:not(.light) pre>code .built_in,:root:not(.light) pre>code .class .title{color:#e6c07b}:root:not(.light) pre>code .attr,:root:not(.light) pre>code .number,:root:not(.light) pre>code .selector-attr,:root:not(.light) pre>code .selector-class,:root:not(.light) pre>code .selector-pseudo,:root:not(.light) pre>code .template-variable,:root:not(.light) pre>code .type,:root:not(.light) pre>code .variable{color:#d19a66}:root:not(.light) pre>code .bullet,:root:not(.light) pre>code .link,:root:not(.light) pre>code .meta,:root:not(.light) pre>code .selector-id,:root:not(.light) pre>code .symbol,:root:not(.light) pre>code .title{color:#61aeee}:root:not(.light) pre>code::-webkit-scrollbar-thumb{background-color:#cbcbcb!important}:root:not(.light) pre>code::-webkit-scrollbar-corner,:root:not(.light) pre>code::-webkit-scrollbar-track-piece{background:#282c34!important}}pre>code{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#eee;font-family:'Roboto Mono',Consolas,Menlo,Monaco,'Source Code Pro','Courier New',monospace}pre>code .comment,pre>code .quote{color:#a0a1a7;font-style:italic}pre>code .doctag,pre>code .formula,pre>code .keyword{color:#a626a4}pre>code .deletion,pre>code .name,pre>code .section,pre>code .selector-tag,pre>code .subst{color:#e45649}pre>code .literal{color:#0184bb}pre>code .addition,pre>code .attribute,pre>code .meta-string,pre>code .regexp,pre>code .string{color:#50a14f}pre>code .built_in,pre>code .class .title{color:#c18401}pre>code .attr,pre>code .number,pre>code .selector-attr,pre>code .selector-class,pre>code .selector-pseudo,pre>code .template-variable,pre>code .type,pre>code .variable{color:#986801}pre>code .bullet,pre>code .link,pre>code .meta,pre>code .selector-id,pre>code .symbol,pre>code .title{color:#4078f2}pre>code .emphasis{font-style:italic}pre>code .strong{font-weight:700}pre>code .link{text-decoration:underline}pre>code::-webkit-scrollbar{width:8px;height:6px}pre>code::-webkit-scrollbar-thumb{border-radius:4px;background-color:#cbcbcb!important}pre>code::-webkit-scrollbar-corner,pre>code::-webkit-scrollbar-track-piece{background:#eee!important}img[data-action=zoom]{cursor:zoom-in}.zoom-img,.zoom-img-wrap{position:relative;z-index:666;transition:all .3s}img.zoom-img{cursor:zoom-out}.zoom-overlay{z-index:420;background:var(--bg);position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;filter:'alpha(opacity=0)';opacity:0;transition:opacity .3s ease-in-out}.zoom-overlay-open .zoom-overlay{filter:'alpha(opacity=100)';opacity:1}.zoom-overlay-open,.zoom-overlay-transitioning{cursor:default}.zoom-overlay-transitioning .zoom-overlay{opacity:0}</style><div class="post card"><img id=post-feature class=feature src=https://vip2.loli.io/2021/02/28/XMjiBGVdHmARW48.png crossorigin alt="年轻人的第一个 ASN"><div class=post-container><h1 class=post-title id=post-title>年轻人的第一个 ASN</h1><div class=post-meta id=post-info><div class=post-meta-left><time class=time id=post-time>2021-03-21</time><div class=post-categories><i class=dot></i> <a href=/categories/%E6%8A%80%E6%9C%AF%E5%90%91/ class=category>技术向</a></div><i class=dot></i><div class=post-wordcount>&nbsp;4 千字</div></div><div class="post-meta-right post-tags"><a href=/tags/BGP/ class=tag>#BGP</a></div></div><div class=hidden id=article-expire>本文最后更新于 <span id=article-expire-day>-1</span> 天前，文中所描述的信息可能已发生改变。</div><script>var updateTime=1616259969e3,updated=Math.floor(((new Date).getTime()-updateTime)/864e5);updated>182&&(document.getElementById("article-expire-day").textContent=updated,document.getElementById("article-expire").classList.remove("hidden"))</script><div class=content id=post-content><p>很久之前就有了这样的一个想法：拥有一个自己的 ASN 。2021 年的寒假末尾，我终于找到了一个肯给我这个未成年人申请 ASN 的 LIR 。<br><s>于是这个世界上又多了一个祸害公网的人。</s></p><span id=more></span><h2 id=注册-asn><a class=anchor href=#注册-asn></a>注册 ASN</h2><p>我找了某个 LIR 注册的 APNIC 的 ASN ，下号用时 3 个工作日。</p><p>需要提供的信息有这些（带有 <code>[保密]</code> 标签的是非公开信息）：</p><ol><li>[保密] 身份证明材料</li><li>主标识</li><li>联系人邮箱</li><li>noc 邮箱</li><li>abuse 邮箱</li><li>国家</li><li>联系人地址</li><li>联系人姓名</li><li>联系人电话</li><li>ASN 的标识</li><li>ASN 的全名</li><li>ASN 所属国家</li><li>[保密] 两个上游 ASN</li><li>[保密] ASN 将要部署在的物理位置</li></ol><p>然后等了 3 个工作日，我的 ASN 申请终于通过审核了（其实在这之前我已经去上学了）。</p><p>需要注意的是 APNIC 每半年会向联系人邮箱发送一封验证邮件，所以邮箱需要保持畅通。</p><h2 id=申请-vultr-bgp-广播功能><a class=anchor href=#申请-vultr-bgp-广播功能></a>申请 Vultr BGP 广播功能</h2><p>我的 LIR 为我提供了一段 <code>/44</code> 的 IP （而不是 <code>/48</code>）：<code>2406:840:e080::/44</code> 。</p><p>由于某些原因，我选择了使用 Vultr 来进行 IP 的广播，当然 HE 的 BGP 隧道也是可以的。</p><p>点击 <a target=_blank rel="noopener external nofollow noreferrer" href=https://my.vultr.com/bgp/ >https://my.vultr.com/bgp/</a> 进入 Vultr BGP 广播功能的开通页面。</p><p><img src=https://vip2.loli.io/2021/03/12/aYNdpciAb217wuP.png alt loading=lazy data-action=zoom></p><p>点击页面中的 <strong>Get Started</strong> 进入 BGP 开通申请页面。</p><p><img src=https://vip1.loli.io/2021/03/12/Sb6AoPXTuJ3YIKn.png alt loading=lazy data-action=zoom></p><ol><li>将 <strong>I have my own IP space</strong> 和 <strong>I have my own ASN</strong> 设置为 YES</li><li>在 <strong>My ASN</strong> 处填写 ASN （不含 <code>AS</code> 前缀）</li><li>在 <strong>BGP Password</strong> 处填写你想要的 BGP 密码</li><li>在 <strong>IP Prefixes</strong> 处填写你的 IP 前缀（CIDR 格式）</li><li><strong>Routes we shoule send you</strong> 选择 <strong>Full Table</strong></li></ol><p>然后点击 <strong>Setup</strong> 即可。</p><blockquote><p><strong>小插曲</strong></p><p>由于我的 LIR 忘记了给我设置 RPKI 记录，导致出现了没有查询到 RPKI 记录的错误。</p></blockquote><hr><p>这是一篇 LOA 模板，照抄即可。</p><pre><code class="highlight text">AUTHORIZATION LETTER

[日期, 如 Feb 27, 2021]

To whom it may concern,

This letter serves as authorization for [服务商公司名, 如 Vultr] with [ASN, 如 AS2333] to announce the following IP address blocks:

[IP SPACE / ASN / SUBNET]
[IP SPACE / ASN / SUBNET]
[...]

As a representative of the company [公司名称] that is the owner of the subnet and/or ASN, I hereby declare that I&#x27;m authorized to represent and sign for this LOA.

Should you have questions about this request, email me at [邮箱], or call: [电话号码]

From,

[姓名]
[公司名称]
[职位, 如 Network Administrator]
[电话号码]</code></pre><hr><p><img src=https://vip2.loli.io/2021/03/13/nbQxcZLFNV6KBgP.png alt loading=lazy data-action=zoom></p><p>提交完毕之后会出现如图所示的界面，点击 <strong>Start</strong> 即可开始验证进程。</p><p><img src=https://vip1.loli.io/2021/03/13/6QKhFL4PGxoeEXn.png alt loading=lazy data-action=zoom></p><p>以 asn 141776 的验证为例，选择好接收验证邮件的邮箱，然后点击 <strong>Send</strong> 即可。</p><p><img src=https://vip2.loli.io/2021/03/13/rE4txqgBLeZK9Ou.png alt loading=lazy data-action=zoom></p><p><img src=https://vip2.loli.io/2021/03/13/rAOSIP5oezGRqpc.png alt loading=lazy data-action=zoom></p><p>点击邮箱里的链接即可（第一个是允许，第二个是拒绝）</p><p><img src=https://vip2.loli.io/2021/03/13/xBXiqmukOQbZT6r.png alt loading=lazy data-action=zoom></p><p>验证成功后的提示。</p><p>之后等待客服开通即可。<br>由于我是在半夜申请的 Vultr BGP 服务，所以几分钟就开通好了。</p><p><img src=https://vip2.loli.io/2021/03/13/2aLwgPWHzlxF9DY.png alt loading=lazy data-action=zoom></p><p>之后不要忘记去控制台重启实例哦~</p><h2 id=使用-bird-1-6-广播-ip><a class=anchor href=#使用-bird-1-6-广播-ip></a>使用 BIRD 1.6 广播 IP</h2><p>目前 BIRD 1.x 和 2.x 同时在维护，二者的区别是 1.x 中 IPv4 和 IPv6 协议是分开的（bird 和 bird6），而 2.x 将两部分代码合并在了一起还引入了更多新功能。<br>1.x 和 2.x 两个版本的语法并无差别，只是 2.x 在涉及与路由表相关的操作的时候，需要指定特别的协议（<code>ipv4</code> 或 <code>ipv6</code>）。</p><p><a target=_blank rel="noopener external nofollow noreferrer" href="https://bird.network.cz/?get_doc&amp;f=bird.html&amp;v=20">BIRD 2.x 官方文档</a></p><p>我选用的是 CentOS 7 系统 + BIRD 1.6.8 的组合。</p><p>由于直接使用 yum 安装 bird6 会出现无法找到包的情况，我们需要先通过 yum 安装 epel。</p><pre><code class="highlight bash">yum install epel-release -y</code></pre><h3 id=安装-bird><a class=anchor href=#安装-bird></a>安装 bird</h3><p>安装 bird6 ：</p><pre><code class="highlight bash">yum install bird6 -y</code></pre><h3 id=配置-bird><a class=anchor href=#配置-bird></a>配置 bird</h3><p>安装完成后先停止 bird 服务：</p><pre><code class="highlight bash">systemctl stop bird6</code></pre><p>由于默认的配置文件注释的内容过多，推荐先删除原有配置文件里面的全部内容。</p><p>使用你喜欢的编辑器编辑 <code>/etc/bird6.conf</code> ，填入如下方所示的配置：</p><pre><code class="highlight nginx"><span class=attribute>router</span> id [实例的 IPv4 地址];

<span class=attribute>define</span> OWNIP = [实例的 IPv6 地址];
<span class=attribute>define</span> OWNAS = [ASN, 不含 AS 前缀];

<span class=attribute>protocol</span> device &#123;
    <span class=attribute>scan</span> time <span class=number>20</span>;
&#125;

<span class=attribute>protocol</span> static &#123;
    <span class=attribute>route</span> [要广播的 IP 地址, CIDR 格式] via OWNIP;
&#125;

<span class=attribute>protocol</span> bgp vultr &#123;
    <span class=attribute>local</span> as OWNAS;
    <span class=attribute>source</span> address OWNIP;
    <span class=attribute>import</span> <span class=literal>none</span>;
    <span class=attribute>export</span> all;
    <span class=attribute>graceful</span> restart <span class=literal>on</span>;
    <span class=attribute>multihop</span> <span class=number>2</span>;
    <span class=attribute>neighbor</span> <span class=number>2001</span>:19f0:ffff::<span class=number>1</span> as <span class=number>64515</span>;
    <span class=attribute>password</span> <span class=string>&quot;[你设置的 BGP 密码]&quot;</span>;
&#125;</code></pre><p>之后保存配置文件，启动广播。</p><pre><code class="highlight bash">systemctl start bird6</code></pre><p><img src=https://vip1.loli.io/2021/03/13/R3UZXdnOx7yTVhc.png alt loading=lazy data-action=zoom></p><p>可以使用 <code>birdc6 show route</code> 和 <code>birdc6 show proto all</code> 命令查看状态。</p><h3 id=添加虚拟网卡><a class=anchor href=#添加虚拟网卡></a>添加虚拟网卡</h3><p>接下来需要创建一个虚拟网卡并设置一个 IP ：</p><pre><code class="highlight bash">ip link add dev baoshuo1 <span class=built_in>type</span> dummy
ip link <span class=built_in>set</span> baoshuo1 up
ip addr add dev baoshuo1 2406:840:e080::1/128</code></pre><p>在 <code>/etc/bird6.conf</code> 的末尾添加以下内容：</p><pre><code class="highlight fortran">protocol <span class=keyword>direct</span> &#123;
    <span class=keyword>interface</span> <span class=string>&quot;baoshuo*&quot;</span>;
    <span class=keyword>import</span> <span class=built_in>all</span>;
&#125;</code></pre><p>之后使用 <code>systemctl reload bird6</code> 命令重载 bird 即可。</p><h2 id=使用-bird2-广播-ip><a class=anchor href=#使用-bird2-广播-ip></a>使用 BIRD2 广播 IP</h2><h3 id=安装-bird2><a class=anchor href=#安装-bird2></a>安装 BIRD2</h3><p>由于直接使用 yum 安装 bird6 会出现无法找到包的情况，我们需要先通过 yum 安装 epel。</p><pre><code class="highlight bash">yum install epel-release -y</code></pre><p>安装 bird2 ：</p><pre><code class="highlight bash">yum install bird2 -y</code></pre><h3 id=配置-bird2><a class=anchor href=#配置-bird2></a>配置 BIRD2</h3><p>BIRD2 的配置文件在 <code>/etc/bird.conf</code> 目录下。</p><pre><code class="highlight puppet">router id [实例的 IPv4 地址];

<span class=keyword>define</span> <span class=section>OWNIP</span> = [实例的 IPv6 地址];
<span class=keyword>define</span> <span class=section>OWNAS</span> = [ASN, 不含 AS 前缀];

protocol <span class=keyword>device</span> &#123;
    scan time <span class=number>20</span>;
&#125;

<span class=keyword>protocol</span> <span class=keyword>static</span> &#123;
    ipv6;
    route [要广播的 IP 地址, CIDR 格式] via OWNIP;
&#125;

<span class=keyword>protocol</span> <span class=keyword>bgp</span> <span class=keyword>lsy</span> &#123;
    local as OWNAS;
    <span class=literal>source</span> address OWNIP;
    <span class=keyword>import</span> none;
    export all;
    graceful <span class=literal>restart</span> on;
    multihop <span class=number>2</span>;
    neighbor <span class=number>2001</span>:<span class=number>19</span>f<span class=number>0</span>:ffff::<span class=number>1</span> as <span class=number>64515</span>;
    <span class=literal>password</span> <span class=string>&quot;[你设置的 BGP 密码]&quot;</span>;
&#125;

<span class=keyword>protocol</span> <span class=keyword>direct</span> &#123;
    interface <span class=string>&quot;baoshuo*&quot;</span>;
    ipv6 &#123;
        <span class=keyword>import</span> all;
    &#125;;
&#125;</code></pre><p>由于我的需求比较简陋，所以配置文件并无较大改动。</p><p><img src=https://vip2.loli.io/2021/03/26/Sdw9oWyuKiZNUpL.png alt loading=lazy data-action=zoom></p><h2 id=拆分-ip-段><a class=anchor href=#拆分-ip-段></a>拆分 IP 段</h2><p>由于我一下子用不了那么多 IP，所以我决定拆分一下。</p><p>如果不涉及 whois 信息的修改操作，那么只需要修改一下 bird 的配置分开广播即可。</p><p>APNIC 修改 whois 信息的流程可以参考 <a target=_blank rel="noopener external nofollow noreferrer" href=https://www.apnic.net/manage-ip/using-whois/updating-whois/objects/email-updates/ >https://www.apnic.net/manage-ip/using-whois/updating-whois/objects/email-updates/</a> 。</p><h2 id=peer><a class=anchor href=#peer></a>Peer</h2><p>首先编写一个模板，像下面这样：</p><pre><code class="highlight pgsql"># /etc/bird6.conf
<span class=keyword>template</span> bgp peers6 &#123;
    <span class=keyword>local</span> OWNIP <span class=keyword>as</span> OWNAS;
    <span class=type>path</span> metric <span class=number>1</span>;
    <span class=keyword>import</span> keep filtered;
    <span class=keyword>import</span> <span class=keyword>filter</span> &#123;
        print &quot;WARNING: no import filter set, all routes will be rejected.&quot;;
        reject;
    &#125;;
    export <span class=keyword>filter</span> &#123;
        print &quot;WARNING: no export filter set, all routes will be rejected.&quot;;
        reject;
    &#125;;
    <span class=keyword>import</span> <span class=keyword>limit</span> <span class=number>1000</span> action block;
    export <span class=keyword>limit</span> <span class=number>1000</span> action block;
&#125;

<span class=keyword>include</span> &quot;/etc/bird/peers6/*&quot;;</code></pre><p>如果需要 Peer ，就在 <code>/etc/bird/peers6/</code> 目录下新建一个任意名称配置文件，如下所示（需要自行替换尖角括号括住的内容）：</p><pre><code class="highlight routeros"><span class=comment># /etc/bird/peers6/&lt;PEER_NAME&gt;.conf</span>
protocol<span class=built_in> bgp </span>&lt;PEER_NAME&gt; <span class=keyword>from</span> peers6 &#123;
   <span class=built_in> neighbor </span>&lt;PEER_IP&gt; as &lt;PEER_ASN&gt;;
    import all;
    <span class=builtin-name>export</span><span class=built_in> filter </span>myexport;
&#125;</code></pre><p><img src=https://vip2.loli.io/2021/03/27/IsGKxX9wRAUNBrH.png alt loading=lazy data-action=zoom></p><h2 id=术语解释><a class=anchor href=#术语解释></a>术语解释</h2><ul><li>LIR: 本地互联网注册机构</li><li>RIR: 区域互联网注册机构 （<a target=_blank rel="noopener external nofollow noreferrer" href=https://zh.wikipedia.org/zh-cn/%E5%8C%BA%E5%9F%9F%E4%BA%92%E8%81%94%E7%BD%91%E6%B3%A8%E5%86%8C%E7%AE%A1%E7%90%86%E6%9C%BA%E6%9E%84>维基百科</a>）</li><li>ASN: 自治系统编号（<a target=_blank rel="noopener external nofollow noreferrer" href=https://zh.wikipedia.org/zh-cn/%E8%87%AA%E6%B2%BB%E7%B3%BB%E7%BB%9F>维基百科</a>）</li><li>BGP: 边界网关协议（<a target=_blank rel="noopener external nofollow noreferrer" href=https://zh.wikipedia.org/zh-cn/%E8%BE%B9%E7%95%8C%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE>维基百科</a>）</li><li>BIRD: 一个功能齐全的动态 IP 路由守护程序（<a target=_blank rel="noopener external nofollow noreferrer" href=https://bird.network.cz>官方网站</a>）</li></ul><h2 id=参考资料><a class=anchor href=#参考资料></a>参考资料</h2><ol><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://www.vultr.com/docs/example-letter-of-authorization-for-bgp-announcements>Example Letter of Authorization for BGP Announcements - Vultr Docs</a></li><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://blog.lsc.moe/post/12/ >IP 广播 : CentOS 7 使用 bird6 广播 IPv6 - LiCEO</a></li></ol></div></div></div><div class="license card" id=post-license><div class=license-title>年轻人的第一个 ASN</div><div class=license-link><a href=https://blog.baoshuo.ren/post/my-own-asn/ >https://blog.baoshuo.ren/post/my-own-asn/</a></div><div class=license-meta><div class=license-meta-item><div class=license-meta-title>本文作者</div><div class=license-meta-text>宝硕</div></div><div class=license-meta-item><div class=license-meta-title>发布于</div><div class=license-meta-text>2021-03-21</div></div><div class=license-meta-item><div class=license-meta-title>许可协议</div><div class=license-meta-text><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.txt target=_blank rel="license external nofollow noopener noopenner noreferrer">CC BY-NC-SA 4.0</a></div></div></div></div><div class="afdian card" style=text-align:center><div class=donation-label>喜欢这篇文章？为什么不考虑打赏一下作者呢？</div><a class="afdian-button button" href=https://afdian.net/@baoshuo rel="nofollow noopener" target=_blank>爱发电</a></div><div class=pagination-container id=pagination><div class=prev-page><i class=i-prev></i> <a href=/post/dn42-network/ >初探 DN42 网络</a></div><div class=next-page><a href=/post/workbox-service-worker/ >初识 Service Worker —— 使用 Workbox 快速开发 Service Worker</a> <i class=i-next></i></div></div><div class="disqus card" id=disqus_thread></div><script>var disqus_options={shortname:"baoshuo",api:"https://api.baoshuo.ren/disqus/api/",apikey:"SysuSvnZJi7nYvWwH14fu42b1CowDBsAH3Ol3UIsqdRbEcQwGFpWuUPkcX93ffCJ",identifier:location.pathname,title:"年轻人的第一个 ASN",siteName:"宝硕博客",admin:"renbaoshuo"}</script><script defer=defer src=/scripts/disqus.lazyload.js></script><div class=post-toc id=post-toc><div class=toc-label><div>文章目录</div><a href=javascript:; rel="external nofollow noreferrer" id=post-toc-close><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 320 512" height=16 width=16><path d="M193.94 256L296.5 153.44l21.15-21.15c3.12-3.12 3.12-8.19 0-11.31l-22.63-22.63c-3.12-3.12-8.19-3.12-11.31 0L160 222.06 36.29 98.34c-3.12-3.12-8.19-3.12-11.31 0L2.34 120.97c-3.12 3.12-3.12 8.19 0 11.31L126.06 256 2.34 379.71c-3.12 3.12-3.12 8.19 0 11.31l22.63 22.63c3.12 3.12 8.19 3.12 11.31 0L160 289.94 262.56 392.5l21.15 21.15c3.12 3.12 8.19 3.12 11.31 0l22.63-22.63c3.12-3.12 3.12-8.19 0-11.31L193.94 256z" fill=currentColor /></svg></a></div><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%B3%A8%E5%86%8C-asn><span class=toc-text>注册 ASN</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%94%B3%E8%AF%B7-vultr-bgp-%E5%B9%BF%E6%92%AD%E5%8A%9F%E8%83%BD><span class=toc-text>申请 Vultr BGP 广播功能</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%BD%BF%E7%94%A8-bird-1-6-%E5%B9%BF%E6%92%AD-ip><span class=toc-text>使用 BIRD 1.6 广播 IP</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AE%89%E8%A3%85-bird><span class=toc-text>安装 bird</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%85%8D%E7%BD%AE-bird><span class=toc-text>配置 bird</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%B7%BB%E5%8A%A0%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1><span class=toc-text>添加虚拟网卡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%BD%BF%E7%94%A8-bird2-%E5%B9%BF%E6%92%AD-ip><span class=toc-text>使用 BIRD2 广播 IP</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AE%89%E8%A3%85-bird2><span class=toc-text>安装 BIRD2</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%85%8D%E7%BD%AE-bird2><span class=toc-text>配置 BIRD2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%8B%86%E5%88%86-ip-%E6%AE%B5><span class=toc-text>拆分 IP 段</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#peer><span class=toc-text>Peer</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%9C%AF%E8%AF%AD%E8%A7%A3%E9%87%8A><span class=toc-text>术语解释</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99><span class=toc-text>参考资料</span></a></li></ol></div><script src=https://cdn.jsdelivr.net/npm/@nishanths/zoom.js@3.1.0/dist/zoom.min.js></script><script>document.addEventListener("DOMContentLoaded",(function(){document.getElementById("toc-btn").onclick=function(){document.getElementById("post-toc").classList.add("active")},document.getElementById("post-toc-close").onclick=function(){document.getElementById("post-toc").classList.remove("active")},Array.from(document.getElementsByClassName("toc-link")).forEach((function(t){t.addEventListener("click",(function(t){document.getElementById("post-toc").classList.remove("active")}))}))}))</script></main><footer class=footer><div>Copyright &copy; 2019-2021 Baoshuo's Blog · <a target=_blank href=https://beian.miit.gov.cn rel="nofollow noopener">冀ICP备15024669号</a></div><div>Theme by <a rel="my noopener" href=https://baoshuo.ren target=_blank>Baoshuo</a> · Powered by <a href=https://hexo.io rel="nofollow noopener" target=_blank>Hexo</a></div></footer><script async src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js></script><div class=fab><a aria-label=文章目录 class=fab-btn id=toc-btn href=javascript:; rel="external nofollow noreferrer" title=文章目录><svg xmlns=http://www.w3.org/2000/svg aria-hidden=true focusable=false data-icon=list-ul class="svg-inline--fa fa-list-ul fa-w-16" role=img viewBox="0 0 512 512" height=20 width=20><path fill=currentColor d="M48 48a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm448 16H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"/></svg> </a><a aria-label=回到顶部 class=fab-btn href=# title=回到顶部><svg xmlns=http://www.w3.org/2000/svg aria-hidden=true focusable=false role=img viewBox="0 0 320 512" height=20 width=20><path fill=currentColor d="M168.5 164.2l148 146.8c4.7 4.7 4.7 12.3 0 17l-19.8 19.8c-4.7 4.7-12.3 4.7-17 0L160 229.3 40.3 347.8c-4.7 4.7-12.3 4.7-17 0L3.5 328c-4.7-4.7-4.7-12.3 0-17l148-146.8c4.7-4.7 12.3-4.7 17 0z"/></svg></a></div></div><script type=application/ld+json>{"@context":"http://schema.org","author":{"@type":"Person","name":"宝硕","sameAs":["https://baoshuo.ren","https://oi.baoshuo.ren","https://twitter.com/renbaoshuo","https://t.me/renbaoshuo"],"description":"学习，就是发现自己越来越菜的过程。","url":"https://baoshuo.ren","image":"https://cdn.jsdelivr.net/npm/bsi@0.0.4/avatar/512x512.png"},"publisher":{"@type":"Organization","name":"宝硕博客","image":"https://cdn.jsdelivr.net/npm/bsi@0.0.4/avatar/512x512.png","logo":{"@type":"ImageObject","url":"https://cdn.jsdelivr.net/npm/bsi@0.0.4/avatar/512x512.png"}},"name":"宝硕博客","url":"https://blog.baoshuo.ren/post/my-own-asn/","keywords":["宝硕","Baoshuo","Ren Baoshuo","@renbaoshuo","@baoshuo","Blog","Web","Hexo","自动化","GitHub Actions","Vercel","Netlify","Cloudflare","CTF","Hackergame","Web","HTTP","JavaScript","Linux","VMware","Cloudflare","Linux","BIRD","BGP","DN42","BGP","DN42","BGP"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.baoshuo.ren/post/my-own-asn/"},"@type":"BlogPosting","articleBody":"很久之前就有了这样的一个想法：拥有一个自己的 ASN 。2021 年的寒假末尾，我终于找到了一个肯给我这个未成年人申请 ASN 的 LIR 。\n于是这个世界上又多了一个祸害公网的人。\n\n注册 ASN\n我找了某个 LIR 注册的 APNIC 的 ASN ，下号用时 3 个工作日。\n需要提供的信息有这些（带有 [保密] 标签的是非公开信息）：\n\n[保密] 身份证明材料\n主标识\n联系人邮箱\nnoc 邮箱\nabuse 邮箱\n国家\n联系人地址\n联系人姓名\n联系人电话\nASN 的标识\nASN 的全名\nASN 所属国家\n[保密] 两个上游 ASN\n[保密] ASN 将要部署在的物理位置\n\n然后等了 3 个工作日，我的 ASN 申请终于通过审核了（其实在这之前我已经去上学了）。\n需要注意的是 APNIC 每半年会向联系人邮箱发送一封验证邮件，所以邮箱需要保持畅通。\n申请 Vultr BGP 广播功能\n我的 LIR 为我提供了一段 /44 的 IP （而不是 /48）：2406:840:e080::/44 。\n由于某些原因，我选择了使用 Vultr 来进行 IP 的广播，当然 HE 的 BGP 隧道也是可以的。\n点击 https://my.vultr.com/bgp/ 进入 Vultr BGP 广播功能的开通页面。\n\n点击页面中的 Get Started 进入 BGP 开通申请页面。\n\n\n将 I have my own IP space 和 I have my own ASN 设置为 YES\n在 My ASN 处填写 ASN （不含 AS 前缀）\n在 BGP Password 处填写你想要的 BGP 密码\n在 IP Prefixes 处填写你的 IP 前缀（CIDR 格式）\nRoutes we shoule send you 选择 Full Table\n\n然后点击 Setup 即可。\n\n小插曲\n由于我的 LIR 忘记了给我设置 RPKI 记录，导致出现了没有查询到 RPKI 记录的错误。\n\n\n这是一篇 LOA 模板，照抄即可。\nAUTHORIZATION LETTER\n\n[日期, 如 Feb 27, 2021]\n\nTo whom it may concern,\n\nThis letter serves as authorization for [服务商公司名, 如 Vultr] with [ASN, 如 AS2333] to announce the following IP address blocks:\n\n[IP SPACE / ASN / SUBNET]\n[IP SPACE / ASN / SUBNET]\n[...]\n\nAs a representative of the company [公司名称] that is the owner of the subnet and/or ASN, I hereby declare that I&#x27;m authorized to represent and sign for this LOA.\n\nShould you have questions about this request, email me at [邮箱], or call: [电话号码]\n\nFrom,\n\n[姓名]\n[公司名称]\n[职位, 如 Network Administrator]\n[电话号码]\n\n\n提交完毕之后会出现如图所示的界面，点击 Start 即可开始验证进程。\n\n以 asn 141776 的验证为例，选择好接收验证邮件的邮箱，然后点击 Send 即可。\n\n\n点击邮箱里的链接即可（第一个是允许，第二个是拒绝）\n\n验证成功后的提示。\n之后等待客服开通即可。\n由于我是在半夜申请的 Vultr BGP 服务，所以几分钟就开通好了。\n\n之后不要忘记去控制台重启实例哦~\n使用 BIRD 1.6 广播 IP\n目前 BIRD 1.x 和 2.x 同时在维护，二者的区别是 1.x 中 IPv4 和 IPv6 协议是分开的（bird 和 bird6），而 2.x 将两部分代码合并在了一起还引入了更多新功能。\n1.x 和 2.x 两个版本的语法并无差别，只是 2.x 在涉及与路由表相关的操作的时候，需要指定特别的协议（ipv4 或 ipv6）。\nBIRD 2.x 官方文档\n我选用的是 CentOS 7 系统 + BIRD 1.6.8 的组合。\n由于直接使用 yum 安装 bird6 会出现无法找到包的情况，我们需要先通过 yum 安装 epel。\nyum install epel-release -y\n安装 bird\n安装 bird6 ：\nyum install bird6 -y\n配置 bird\n安装完成后先停止 bird 服务：\nsystemctl stop bird6\n由于默认的配置文件注释的内容过多，推荐先删除原有配置文件里面的全部内容。\n使用你喜欢的编辑器编辑 /etc/bird6.conf ，填入如下方所示的配置：\nrouter id [实例的 IPv4 地址];\n\ndefine OWNIP = [实例的 IPv6 地址];\ndefine OWNAS = [ASN, 不含 AS 前缀];\n\nprotocol device &#123;\n    scan time 20;\n&#125;\n\nprotocol static &#123;\n    route [要广播的 IP 地址, CIDR 格式] via OWNIP;\n&#125;\n\nprotocol bgp vultr &#123;\n    local as OWNAS;\n    source address OWNIP;\n    import none;\n    export all;\n    graceful restart on;\n    multihop 2;\n    neighbor 2001:19f0:ffff::1 as 64515;\n    password &quot;[你设置的 BGP 密码]&quot;;\n&#125;\n之后保存配置文件，启动广播。\nsystemctl start bird6\n\n可以使用 birdc6 show route 和 birdc6 show proto all 命令查看状态。\n添加虚拟网卡\n接下来需要创建一个虚拟网卡并设置一个 IP ：\nip link add dev baoshuo1 type dummy\nip link set baoshuo1 up\nip addr add dev baoshuo1 2406:840:e080::1/128\n在 /etc/bird6.conf 的末尾添加以下内容：\nprotocol direct &#123;\n    interface &quot;baoshuo*&quot;;\n    import all;\n&#125;\n之后使用 systemctl reload bird6 命令重载 bird 即可。\n使用 BIRD2 广播 IP\n安装 BIRD2\n由于直接使用 yum 安装 bird6 会出现无法找到包的情况，我们需要先通过 yum 安装 epel。\nyum install epel-release -y\n安装 bird2 ：\nyum install bird2 -y\n配置 BIRD2\nBIRD2 的配置文件在 /etc/bird.conf 目录下。\nrouter id [实例的 IPv4 地址];\n\ndefine OWNIP = [实例的 IPv6 地址];\ndefine OWNAS = [ASN, 不含 AS 前缀];\n\nprotocol device &#123;\n    scan time 20;\n&#125;\n\nprotocol static &#123;\n    ipv6;\n    route [要广播的 IP 地址, CIDR 格式] via OWNIP;\n&#125;\n\nprotocol bgp lsy &#123;\n    local as OWNAS;\n    source address OWNIP;\n    import none;\n    export all;\n    graceful restart on;\n    multihop 2;\n    neighbor 2001:19f0:ffff::1 as 64515;\n    password &quot;[你设置的 BGP 密码]&quot;;\n&#125;\n\nprotocol direct &#123;\n    interface &quot;baoshuo*&quot;;\n    ipv6 &#123;\n        import all;\n    &#125;;\n&#125;\n由于我的需求比较简陋，所以配置文件并无较大改动。\n\n拆分 IP 段\n由于我一下子用不了那么多 IP，所以我决定拆分一下。\n如果不涉及 whois 信息的修改操作，那么只需要修改一下 bird 的配置分开广播即可。\nAPNIC 修改 whois 信息的流程可以参考 https://www.apnic.net/manage-ip/using-whois/updating-whois/objects/email-updates/ 。\nPeer\n首先编写一个模板，像下面这样：\n# /etc/bird6.conf\ntemplate bgp peers6 &#123;\n    local OWNIP as OWNAS;\n    path metric 1;\n    import keep filtered;\n    import filter &#123;\n        print &quot;WARNING: no import filter set, all routes will be rejected.&quot;;\n        reject;\n    &#125;;\n    export filter &#123;\n        print &quot;WARNING: no export filter set, all routes will be rejected.&quot;;\n        reject;\n    &#125;;\n    import limit 1000 action block;\n    export limit 1000 action block;\n&#125;\n\ninclude &quot;/etc/bird/peers6/*&quot;;\n如果需要 Peer ，就在 /etc/bird/peers6/ 目录下新建一个任意名称配置文件，如下所示（需要自行替换尖角括号括住的内容）：\n# /etc/bird/peers6/&lt;PEER_NAME&gt;.conf\nprotocol bgp &lt;PEER_NAME&gt; from peers6 &#123;\n    neighbor &lt;PEER_IP&gt; as &lt;PEER_ASN&gt;;\n    import all;\n    export filter myexport;\n&#125;\n\n术语解释\n\nLIR: 本地互联网注册机构\nRIR: 区域互联网注册机构 （维基百科）\nASN: 自治系统编号（维基百科）\nBGP: 边界网关协议（维基百科）\nBIRD: 一个功能齐全的动态 IP 路由守护程序（官方网站）\n\n参考资料\n\nExample Letter of Authorization for BGP Announcements - Vultr Docs\nIP 广播 : CentOS 7 使用 bird6 广播 IPv6 - LiCEO\n\n","dateCreated":"2021-03-21T01:06:09+08:00","dateModified":"2021-03-21T01:06:09+08:00","datePublished":"2021-03-21T01:06:09+08:00","description":"很久之前就有了这样的一个想法：拥有一个自己的 ASN 。2021 年的寒假末尾，我终于找到了一个肯给我这个未成年人申请 ASN 的 LIR 。\n于是这个世界上又多了一个祸害公网的人。","headline":"年轻人的第一个 ASN","thumbnailUrl":"https://vip2.loli.io/2021/02/28/XMjiBGVdHmARW48.png","potentialAction":{"@type":"SearchAction","target":"https://blog.baoshuo.ren/search/?s={search_term_string}","query-input":"required name=search_term_string"}}</script></body></html>